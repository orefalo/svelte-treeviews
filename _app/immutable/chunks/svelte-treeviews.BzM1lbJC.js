var Be=Object.defineProperty;var Pe=i=>{throw TypeError(i)};var je=(i,e,t)=>e in i?Be(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var y=(i,e,t)=>je(i,typeof e!="symbol"?e+"":e,t),Qe=(i,e,t)=>e.has(i)||Pe("Cannot "+t);var ge=(i,e,t)=>(Qe(i,e,"read from private field"),t?t.call(i):e.get(i)),Te=(i,e,t)=>e.has(i)?Pe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import{d as Re,p as se,a as x,s as p,b as R,u as he,o as Ne,c as Ze,g,e as M,f as qe,i as H,t as q,h as C,j as oe,k as E,l as Z,m as Y,n as L,q as ve,r as K,v as ye,w as N,x as xe,y as ee,z as re,A as Ce,B,C as Je,D as We,E as De,F as Ye,G as Xe,H as we,I as $,J as Ge,K as pe,L as de,M as $e,N as Me,O as Le,P as et}from"./external.DFamYjz2.js";const tt="modulepreload",nt=function(i){return"/svelte-treeviews/"+i},ke={},it=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(t.map(l=>{if(l=nt(l),l in ke)return;ke[l]=!0;const a=l.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":tt,a||(c.as="script",c.crossOrigin=""),c.href=l,o&&c.setAttribute("nonce",o),document.head.appendChild(c),a)return new Promise((v,d)=>{c.addEventListener("load",v),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};Re(["click"]);class rt{constructor(e,t,n,r){y(this,"model");y(this,"modelCount");y(this,"itemSize");y(this,"estimatedItemSize");y(this,"itemSizeAndPositionData");y(this,"lastMeasuredIndex");y(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=r,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),r=e;e+=n,this.itemSizeAndPositionData[t]={offset:r,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s===void 0||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:n,size:s},n+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=ce.START,t,n,r){if(t<=0)return 0;const s=this.getSizeAndPositionForIndex(r),o=s.offset,l=o-t+s.size;let a;switch(e){case ce.END:a=l;break;case ce.CENTER:a=o-(t-s.size)/2;break;case ce.START:a=o;break;default:a=Math.max(l,Math.min(o,n))}const u=this.getTotalSize();return Math.max(0,Math.min(u-t,a))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const s=t+e;let o=this.findNearestItem(t);if(o===void 0)throw Error(`Invalid offset ${t} specified`);const l=this.getSizeAndPositionForIndex(o);t=l.offset+l.size;let a=o;for(;t<s&&a<this.modelCount-1;)a++,t+=this.getSizeAndPositionForIndex(a).size;return n&&(o=Math.max(0,o-n),a=Math.min(a+n,this.modelCount-1)),{start:o,end:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let r=0,s=0;for(;e<=t;){if(r=e+Math.floor((t-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===n)return r;s<n?e=r+1:s>n&&(t=r-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}var st=E('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');const ot=(()=>{let i=!1;try{const e=Object.defineProperty({},"passive",{get(){return i={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return i})();function lt(i,e){se(e,!0);const t=x(e,"width",3,"100%"),n=x(e,"model",19,()=>[]),r=x(e,"windowOverPadding",3,3),s=x(e,"scrollDirection",19,()=>V.VERTICAL),o=x(e,"scrollToAlignment",19,()=>ce.AUTO),l=x(e,"scrollToBehaviour",19,()=>Ke.INSTANT),a=x(e,"class",3,"");x(e,"style",3,"");const u={[V.VERTICAL]:"top",[V.HORIZONTAL]:"left"},c={[V.VERTICAL]:"scrollTop",[V.HORIZONTAL]:"scrollLeft"},v=new rt(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let d=!1,h,I=p(R([])),m=p(R({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&U(e.scrollToIndex)||0,scrollChangeReason:ae.REQUESTED})),P={},_={scrollToIndex:e.scrollToIndex,scrollToAlignment:o(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},z={},O=p(""),b=p("");he(()=>{e.scrollToIndex,o(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,j()}),he(()=>{g(m),w()}),he(()=>{e.height,t(),d&&F(0)}),(()=>{if(s()===V.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(s()===V.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());T()})(),Ne(()=>{h.addEventListener("scroll",le,ot),e.scrollOffset!==void 0?A(e.scrollOffset):e.scrollToIndex!==void 0&&A(U(e.scrollToIndex)),d=!0}),Ze(()=>{d&&h.removeEventListener("scroll",le)});function j(){if(!d)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const f=_.scrollToIndex!==e.scrollToIndex||_.scrollToAlignment!==o(),S=_.modelCount!==e.modelCount||_.itemSize!==e.itemSize||_.estimatedItemSize!==e.estimatedItemSize;S&&(v.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),F()),_.scrollOffset!==e.scrollOffset?M(m,R({offset:e.scrollOffset||0,scrollChangeReason:ae.REQUESTED})):typeof e.scrollToIndex=="number"&&(f||S)&&M(m,R({offset:U(e.scrollToIndex,o(),e.modelCount),scrollChangeReason:ae.REQUESTED})),_={scrollToIndex:e.scrollToIndex,scrollToAlignment:o(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function w(){if(!d)return;const{offset:f,scrollChangeReason:S}=g(m);(P.offset!==f||P.scrollChangeReason!==S)&&T(),P.offset!==f&&S===ae.REQUESTED&&A(f),P=g(m)}function T(){if(n().length===0||e.isDisabled)return;const{offset:f}=g(m);let{start:S,end:k}=v.getVisibleRange(s()===V.VERTICAL?e.height:t(),f,r()),Q=[];const J=v.getTotalSize(),ne=typeof e.height=="number"?"px":"",ie=typeof t()=="number"?"px":"";if(s()===V.VERTICAL?(M(O,`height:${e.height}${ne};width:${t()}${ie};`),M(b,`flex-direction:column;height:${J}px;`)):(M(O,`height:${e.height}${ne};width:${t()}${ie};`),M(b,`min-height:100%;width:${J}px;`)),n()&&S!==void 0&&k!==void 0){for(let W=S;W<=k;(W+=1)-1)Q.push({item:n()[W],index:W,style:_e(W)});if(e.onVisibleRangeUpdate){const W=v.getVisibleRange(s()===V.VERTICAL?e.height:t(),f,0);e.onVisibleRangeUpdate({type:"range.update",start:W.start,end:W.end})}}M(I,R(Q))}function A(f){"scroll"in h?h.scroll({[u[s()]]:f,behavior:l()}):h[c[s()]]=f}function F(f=0){z={},v.resetItem(f),T()}function U(f,S=o(),k=e.modelCount){return f<0?f=0:f>=k&&(f=k-1),v.getUpdatedOffsetForIndex(S,s()===V.VERTICAL?e.height:t(),g(m).offset||0,f)}const le=f=>{const S=h[c[s()]];S<0||g(m).offset===S||f.target!==h||(M(m,R({offset:S,scrollChangeReason:ae.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:S,event:f}))};function _e(f){if(z[f])return z[f];const{size:S,offset:k}=v.getSizeAndPositionForIndex(f),Q=s()===V.VERTICAL?`left:0;width:100%;height:${S}px;position:absolute;top:${k}px;`:`top:0;width:${S}px;position:absolute;height:100%;left:${k}px;`;return z[f]=Q}var D=st();qe(D,f=>h=f,()=>h);var fe=K(D);H(fe,()=>e.header,f=>{var S=Y(),k=L(S);re(k,()=>e.header),C(f,S)});var te=Z(fe,2),ze=K(te);H(ze,()=>e.isDisabled,f=>{var S=Y(),k=L(S);ve(k,17,n,ye,(Q,J,ne)=>{var ie=Y(),W=L(ie);re(W,()=>e.vl_slot,()=>({item:g(J),style:"",index:ne})),C(Q,ie)}),C(f,S)},f=>{var S=Y(),k=L(S);ve(k,17,()=>g(I),ye,(Q,J)=>{var ne=Y(),ie=L(ne);re(ie,()=>e.vl_slot,()=>({item:g(J).item,style:g(J).style,index:g(J).index})),C(Q,ne)}),C(f,S)}),N(te);var ue=Z(te,2);return H(ue,()=>e.footer,f=>{var S=Y(),k=L(S);re(k,()=>e.footer),C(f,S)}),N(D),q(()=>{xe(D,`virtual-list-wrapper $${a()??""} svelte-f32i87`),ee(D,"style",g(O)),ee(te,"style",g(b))}),C(i,D),oe({recomputeSizes:F})}var Ke=(i=>(i.AUTO="auto",i.SMOOTH="smooth",i.INSTANT="instant",i))(Ke||{}),ce=(i=>(i.AUTO="auto",i.START="start",i.CENTER="center",i.END="end",i))(ce||{}),V=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(V||{}),ae=(i=>(i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED",i))(ae||{}),dt=E('<div class="tree-line tree-vline svelte-gfld7i"></div>'),at=E('<div class="tree-line tree-hline svelte-gfld7i"></div>'),ct=E("<!> <!>",1),ht=E('<div><!> <div class="tree-node-inner"><!></div></div>');function ft(i,e){se(e,!0);let t=x(e,"rtl",3,!1),n=x(e,"btt",3,!1),r=x(e,"indent",3,20),s=x(e,"treeLine",3,!0),o=x(e,"treeLineOffset",3,10),l=x(e,"class",3,""),a=x(e,"style",3,""),u=B(()=>`${t()?"paddingRight":"paddingLeft"}:${r()*(e.nodeInfo.level-1)}px`),c=B(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*r()+o()}px`);he(()=>{var O,b;const z=e.nodeInfo.expended;console.log("toggleOpen"),!v&&(z?(O=e.onNodeOpened)==null||O.call(e,e.nodeInfo):(b=e.onNodeclosed)==null||b.call(e,e.nodeInfo),d())}),he(()=>{var z,O;e.nodeInfo.checked,!v&&(z=e.processor)!=null&&z.afterOneCheckChanged(e.nodeInfo)&&((O=e.onNodeChecked)==null||O.call(e,e.nodeInfo))});let v=!1;const d=()=>{v=!0,setTimeout(()=>{v=!1},100)},h=B(()=>{const z=[],O=T=>{var A;if(T.parent){let F=(A=T.parent)==null?void 0:A.children.indexOf(T);do{F+=1;const U=T.parent.children[F];if(U){if(!U.hidden)return!0}else break}while(!0)}return!1},b=t()?"right":"left",j=n()?"top":"bottom";let w=e.nodeInfo;for(;w;){const T=(w.level-2)*r()+o(),A=O(w),F=()=>{z.push({style:`${b}:${T}px;${j}:${A?"0":"50%"}`})};w===e.nodeInfo?w.level>1&&F():A&&F(),w=w.parent}return z});var I=ht();q(()=>xe(I,`${Ce("tree-node",l(),s()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var m=K(I);H(m,s,z=>{var O=ct(),b=L(O);ve(b,17,()=>g(h),ye,(w,T)=>{var A=dt();q(()=>ee(A,"style",g(T).style)),C(w,A)});var j=Z(b,2);H(j,()=>e.nodeInfo.level>1,w=>{var T=at();q(()=>ee(T,"style",g(c))),C(w,T)}),C(z,O)});var P=Z(m,2),_=K(P);re(_,()=>e.tn_slot,()=>({data:e.nodeInfo.nodeData,info:e.nodeInfo})),N(P),N(I),q(()=>ee(I,"style",`${a()} ${g(u)}`)),C(i,I),oe()}function be(i){return Object.prototype.toString.call(i)==="[object Array]"}function ut(i){return i[i.length-1]}function gt(i,e){let t,n=0;for(;(t=i.indexOf(e))>-1;)i.splice(t,1),n++;return n}function mt(i,e,t){i.hasOwnProperty(e)||(i[e]=t)}function vt(i,e){return Object.keys(e).forEach(t=>{mt(i,t,e[t])}),i}function It(i){const e={};return Object.keys(i).forEach(t=>{i[t]!==void 0&&(e[t]=i[t])}),e}function X(i,e,t={}){t=vt({...t},{childrenKey:"children"});const n=t.childrenKey,r=be(i)?i:[i];class s{}const o=(l,a,u)=>{t.reverse&&(l=l.slice(),l.reverse());const c=l.length;for(let v=0;v<c;v++){const d=l[v],h=t.reverse?c-v-1:v,I=u?[...u,h]:[];t.childFirst&&d[n]!=null&&o(d[n],d,I);const m=e(d,h,a,I);if(m===!1)throw new s;if(m==="skip children")continue;if(m==="skip siblings")break;t.childFirst||d[n]!=null&&o(d[n],d,I)}};try{o(r,null,be(i)?[]:null)}catch(l){if(!(l instanceof s))throw l}}function St(i,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,r=t.nodeHandler,s=new Oe;return s.childrenKey=n,X(i,(o,l,a,u)=>{let c=Object.assign({},o);c[n]&&(c[n]=[]),r&&(c=r(c,{oldNode:o,index:l,parent:a,path:u})),s.set(u,c)},{childrenKey:n}),s.data}class Oe{constructor(e=[]){y(this,"data");y(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return be(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:r}=this;if(t.reverse){const s=[...this.iteratePath(e,{...t,reverse:!1})];s.reverse();for(const{path:o,node:l}of s)yield{path:o,node:l}}else{let s=[],o=r;for(const l of e){const a=[...s,l],u=o[l];yield{path:a,node:u},s=a,o=u[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return ut(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:r}=this;const{parent:s,index:o}=this.getParentAndIndex(e);let l;e.length===1?(r||(this.data?this.data[n]=[]:this.data=[]),l=r):(s[n]||(s[n]=[]),l=s[n]),l[o]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:r,index:s}=this.getParentAndIndex(e),o=e.length===1?n:r[t],l=o[s];return o.splice(s,1),l}walk(e,t){const{childrenKey:n,data:r}=this;return X(r,e,n)}clone(e={}){return St(this.data),It({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}class me{constructor(e){y(this,"nodeData");y(this,"expended");y(this,"parent");y(this,"children");y(this,"level");y(this,"hidden");y(this,"checked");y(this,"draggable");y(this,"droppable");y(this,"style");y(this,"class");y(this,"_ignoreCheckedOnce");this.nodeData=(e==null?void 0:e.nodeData)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=(e==null?void 0:e.style)||null,this.class=(e==null?void 0:e.class)||null,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}class Fe{constructor(e){y(this,"childrenKey",G);y(this,"defaultOpen",!1);y(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||G,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}afterSetInfoNode(e,t,n){}afterRemoveInfoNode(e){}infoHandler(e){return e}}class xt extends Fe{constructor(t){super(t);y(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=R(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=R(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=R(t);return this.filter(super.InfoNodesFlatHandler,n)}}const G="children";var Ie,Se;class _t{constructor(e){y(this,"nodeData");Te(this,Ie,p(R([])));Te(this,Se,p(R([])));y(this,"_infosMap");y(this,"options");y(this,"initialized",!1);this._infosMap=null,this.options=e||new Fe}get nodeInfos(){return g(ge(this,Ie))}set nodeInfos(e){M(ge(this,Ie),R(e))}get nodeInfosToRender(){return g(ge(this,Se))}set nodeInfosToRender(e){M(ge(this,Se),R(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new Oe([]);this._infosMap=new Map,X(this.nodeData,(r,s,o,l)=>{const a=this.options.infoHandler(new me({nodeData:r,expended:!!this.options.defaultOpen,parent:t.getParent(l),children:[],level:l.length}));this._infosMap.set(r,a),t.set(l,a)},{childrenKey:e}),console.log("td",t),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren);const n=[];t.walk(r=>{n.push(r)}),console.log("rootChildren",t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new Ae("NodeInfo not found");return t}has(e){if(e instanceof me)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof Ae)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=r=>{const s=r.parent;if(s){let o=!1,l=!1;for(const u of s.children)if(u.checked||u.checked===0)o=!0;else if(l=!0,o&&l)break;const a=l?o?0:!1:!0;s.checked!==a&&(this._ignoreCheckedOnce(s),s.checked=a),n(s)}};return n(e),X(e.children,r=>{r.checked!==t&&(this._ignoreCheckedOnce(r),r.checked=t)},{childrenKey:G}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof me?e:this.getNodeInfo(e),n=r=>!r||!r.hidden&&r.expended&&n(r.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){X(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:G})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof me?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const r=e?e.children:this.nodeInfos;for(let s=0;s<t;(s+=1)-1)n+=this._count(r[s]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const r=t?t.children:this.nodeInfos;n==null&&(n=r.length);const s=this.options.infoHandler(new me({expended:!!this.options.defaultOpen,nodeData:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(s,t||null,n);const o=e[this.childrenKey];if(o){const l=o.slice();for(const a of l)this.add(a,s)}}remove(e){const t=this.getSiblings(e);if(t.includes(e)){gt(t,e);const n=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),n.length);for(const r of n)this._infosMap.delete(r.nodeData);return this.options.afterRemoveInfoNode(e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const s=this._calcFlatIndex(t,n),o=this._flat(e);this.nodeInfosToRender.splice(s,0,...o);for(const l of o)this._infosMap.has(l.nodeData)||this._infosMap.set(l.nodeData,l);X(e,(l,a,u)=>{u&&(l.level=u.level+1)},{childrenKey:G}),this.options.afterSetInfoNode(e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let r;for(const s of this.iterateParent(t))if(s.level===e.level){r=s;break}if(e===r)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return X(e,n=>{t.push(n)},{childrenKey:G}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,r=new Oe([]);return r.childrenKey=n,X(t||this.nodeInfos,(s,o,l,a)=>{let u={...s.nodeData,[n]:[]};e&&(u=e(u)),r.set(a,u)},{childrenKey:G}),r.data}}Ie=new WeakMap,Se=new WeakMap;class Ae extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}function yt(i,e){const t=new xt(e),n=new _t(t);return t.noInitialization||n.init(),n}var zt=E('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function Vt(i,e){se(e,!0);let t=x(e,"processor",23,()=>yt([],{noInitialization:!0}));x(e,"updateBehavior",3,"modify"),x(e,"childrenKey",3,G),x(e,"textKey",3,"text");let n=x(e,"indent",3,20),r=x(e,"virtualization",3,!1);x(e,"virtualizationPrerenderCount",3,20),x(e,"defaultOpen",3,!0);let s=x(e,"rtl",3,!1),o=x(e,"btt",3,!1);x(e,"nodeKey",3,"index");let l=x(e,"treeLine",3,!1),a=x(e,"treeLineOffset",3,8);x(e,"class",3,"");let u=x(e,"style",3,""),c=p(R([])),v=null,d=!1,h={};he(()=>{e.model,console.log("model change detected"),console.log("Initializing model"),t().nodeData=e.model,t().init(),M(c,R(t().nodeInfosToRender))});function I(){let b=g(c)||[];return o()&&(b=b.slice().reverse()),b.filter(j=>m(j))}function m(b){return t().isVisible(b)}var P=B(()=>Ce("he-tree",s()&&"he-tree--rtl rtl",d)),_=B(()=>!r()),z=B(I),O=B(()=>{var b;return((b=t().nodeInfos)==null?void 0:b.length)||0});lt(i,{get class(){return g(P)},get style(){return u()},height:500,get isDisabled(){return g(_)},width:"auto",get model(){return g(z)},get modelCount(){return g(O)},itemSize:25,vl_slot:(j,w)=>{let T=()=>w==null?void 0:w().item;var A=Y(),F=L(A);H(F,T,U=>{var le=B(()=>Ce(T().class,{"drag-placeholder-wrapper":T().nodeData===h,"dragging-node":T()===v}));ft(U,{get class(){return g(le)},get style(){return T().style},get nodeInfo(){return T()},get rtl(){return s()},get btt(){return o()},get indent(){return n()},get treeLine(){return l()},get treeLineOffset(){return a()},get processor(){return t()},onNodeOpened:D=>e.onNodeOpened&&e.onNodeOpened(D),onNodeclosed:D=>e.onNodeClosed&&e.onNodeClosed(D),onNodeChecked:D=>e.onNodeChecked&&e.onNodeChecked(D),tn_slot:(D,fe=Je)=>{var te=Y(),ze=L(te);H(ze,()=>fe().data===h,ue=>{var f=zt(),S=K(f);H(S,()=>e.placeholder,k=>{var Q=Y(),J=L(Q);re(J,()=>e.placeholder),C(k,Q)}),N(f),C(ue,f)},ue=>{var f=Y(),S=L(f);re(S,()=>e.tree_slot,fe),C(ue,f)}),C(D,te)}})}),C(j,A)}}),oe()}var Tt=E('<div class="item svelte-1od643n"><!></div>'),Ct=E('<section class="svelte-1od643n"></section>'),bt=E("<b> </b> <!>",1);function Ve(i,e){se(e,!1);let t=x(e,"nodes",12),n=x(e,"node",12);const r=300;function s(v){n(n().items=v.detail.items,!0)}function o(v){n(n().items=v.detail.items,!0),t({...t()})}We();var l=bt(),a=L(l),u=K(a);N(a);var c=Z(a,2);H(c,()=>{var v;return(v=n())==null?void 0:v.hasOwnProperty("items")},v=>{var d=Ct();ve(d,13,()=>n().items,h=>h.id,(h,I)=>{var m=Tt(),P=K(m);Ve(P,{get nodes(){return t()},set nodes(_){t(_)},get node(){return t()[g(I).id]},$$legacy:!0}),N(m),Ye(m,()=>Ge,()=>({duration:r})),C(h,m)}),N(d),Xe(d,(h,I)=>pe(h,I),()=>({items:n().items,flipDurationMs:r,centreDraggedOnCursor:!0})),we(()=>$("consider",d,s)),we(()=>$("finalize",d,o)),C(v,d)}),q(()=>{var v,d;ee(a,"style",`color:${((v=n())==null?void 0:v.color)??""}`),De(u,(d=n())==null?void 0:d.name)}),C(i,l),oe()}var Ot=E("<h3>Try dragging node2 into node3 and then node4 into node2</h3> <!>",1);function Ht(i){let e=$e({node1:{name:"node 1",items:[{id:"node2"},{id:"node3"},{id:"node4"}],id:"node1"},node2:{name:"node 2",items:[{id:"node5"},{id:"node6"},{id:"node7"},{id:"node8"}],id:"node2"},node3:{name:"node 3",items:[{id:"node9"},{id:"node10"},{id:"node11"},{id:"node12"}],id:"node3"},node4:{name:"node 4",items:[{id:"node13"},{id:"node14"},{id:"node15"},{id:"node16"}],id:"node4",color:"salmon"}});for(let r=5;r<17;(r+=1)-1)de(e,g(e)[`node${r}`]={id:`node${r}`,name:`item ${r}`});de(e,g(e).node10.color="steelblue"),de(e,g(e).node11.color="steelblue"),de(e,g(e).node14.color="orange"),de(e,g(e).node15.color="orange"),de(e,g(e).node6.color="forestgreen");var t=Ot(),n=Z(L(t),2);Ve(n,{get node(){return g(e).node1},get nodes(){return g(e)},set nodes(r){M(e,r)},$$legacy:!0}),C(i,t)}var Pt=E("<div></div>");function Ee(i,e){se(e,!0);const{getDragged:t}=Me("dragging");let n=p(!1);function r(c){return 1}function s(c){!c.target||!c.target.id||(r(c.target.id),M(n,!0))}function o(c){!c.target||!c.target.id||(r(c.target.id)>0&&e.ondrop({oldPosition:t(),newPosition:c.target.id.split("-")}),l())}function l(){M(n,!1)}function a(){return`dropzone-${e.prefix}`}var u=Pt();q(()=>ee(u,"id",a())),q(()=>xe(u,`${`dropzone ${g(n)?"active":"idle"}`??""} svelte-1n7j4p5`)),$("dragleave",u,()=>l()),$("dragenter",u,c=>s(c)),$("drop",u,c=>o(c)),$("dragover",u,()=>!1),C(i,u),oe()}var wt=E("<span> </span>");function He(i,e){var t=wt(),n=K(t);N(t),q(()=>{xe(t,`${`clickable ${e.isLeafNode?"isLeafNode":""}`??""} svelte-13dhc3a`),De(n,e.label)}),C(i,t)}const kt=Object.freeze(Object.defineProperty({__proto__:null,default:He},Symbol.toStringTag,{value:"Module"}));function At(i,e){e(!e())}function Et(i,e,t){var n;(n=e.onselected)==null||n.call(e,`${t()}`.split("-"))}var Rt=E("<i></i>"),Nt=E('<li class="svelte-1bsomvo"><!></li>'),Dt=E('<ul class="svelte-1bsomvo"><!> <li class="svelte-1bsomvo"><!></li></ul>'),Mt=E('<!> <div draggable="true"><!> <div class="node-wrapper svelte-1bsomvo"><!></div></div> <!>',1);function Ue(i,e){se(e,!0),Me("dragging");let t=x(e,"expanded",7,!1),n=x(e,"prefix",3,""),r=B(()=>!Array.isArray(e.children)),s=B(()=>n()===null);function o(){}function l(_){var z;!_.target||!_.target.id||(z=e.ondragstart)==null||z.call(e,_.target.id.split("-"))}function a(_){return n()!==null?`${n()}-${_}`:_}var u=Mt(),c=L(u);H(c,()=>!g(s),_=>{Ee(_,{get ondrop(){return e.ondrop},get prefix(){return n()}})});var v=Z(c);v.nodeValue="  ";var d=Z(v),h=K(d);H(h,()=>!g(r),_=>{var z=Rt();z.__click=[At,t],q(()=>xe(z,`${`clickable toggle-icon ${t()?e.internalOptions.collapseClass:e.internalOptions.expandClass}`??""} svelte-1bsomvo`)),C(_,z)});var I=Z(h,2);I.__click=[Et,e,n];var m=K(I);He(m,{get label(){return e.label},get isLeafNode(){return g(r)}}),N(I),N(d);var P=Z(d,2);H(P,()=>t()&&!g(r),_=>{var z=Dt(),O=K(z);ve(O,17,()=>e.children,ye,(T,A,F)=>{var U=Nt(),le=K(U),_e=B(()=>a(F));Ue(le,Le(()=>g(A),{get internalOptions(){return e.internalOptions},get expanded(){return t()},get prefix(){return g(_e)},get onselected(){return e.onselected},ondragenter:!0,ondragleave:!0,get ondragstart(){return e.ondragstart},ondragend:!0,get ondrop(){return e.ondrop}})),N(U),C(T,U)});var b=Z(O,2),j=K(b),w=B(()=>{var T;return a((T=e.children)==null?void 0:T.length)});Ee(j,{get ondrop(){return e.ondrop},get prefix(){return g(w)}}),N(b),N(z),C(_,z)}),q(()=>ee(d,"id",n())),$("dragstart",d,_=>l(_)),$("dragend",d,o),C(i,u),oe()}Re(["click"]);var Lt=E('<div class="tree"><!></div>');function Ut(i,e){se(e,!0);let t={labelFormatter:()=>it(()=>Promise.resolve().then(()=>kt),void 0),collapseClass:"chevron bottom",expandClass:"chevron right"};Ne(async()=>{t=Object.assign(t,e.options)});let n;et("dragging",{getDragged:()=>n});function r(d){var h;(h=e.onselected)==null||h.call(e,o(d.slice(),e.treeItems))}function s(d){n=d.detail}function o(d,h){if(d.length===0)return h;const I=d.shift(),m=h.children[I];return m.hasOwnProperty("children")?o(d,m):m}function l(d,h){let I=[];for(let m=0;m<d.length;(m+=1)-1)d[m]===h&&I.push(m);return I}function a(d,h,I,m){if(d!==h)return d.children.indexOf(m);const P=l(d.children,m);if(P.length!==2){console.error("found too few/too many indexes",P);return}return P.find(_=>`${_}`!=`${I.slice().pop()}`)}function u(d){var O;const h=d.detail.oldPosition.slice(),I=d.detail.newPosition.slice(1),m=o(h.slice(0,h.length-1),e.treeItems),P=o(I.slice(0,I.length-1),e.treeItems),_=o(h.slice(),e.treeItems);P.children.splice(I.slice().pop(),0,_);const z=a(m,P,I.slice(),_);m.children.splice(z,1),n=null,(O=e.onmodelChanged)==null||O.call(e,e.treeItems)}var c=Lt(),v=K(c);H(v,()=>e.treeItems,d=>{Ue(d,Le(()=>e.treeItems,{internalOptions:t,expanded:!0,onselected:h=>r(h.detail),ondragstart:h=>s(h),ondrop:u}))}),N(c),C(i,c),oe()}export{Ht as A,Vt as T,it as _,Ut as a};
