var Qe=Object.defineProperty;var ke=s=>{throw TypeError(s)};var qe=(s,e,t)=>e in s?Qe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var _=(s,e,t)=>qe(s,typeof e!="symbol"?e+"":e,t),Ze=(s,e,t)=>e.has(s)||ke("Cannot "+t);var ve=(s,e,t)=>(Ze(s,e,"read from private field"),t?t.call(s):e.get(s)),Te=(s,e,t)=>e.has(s)?ke("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import{d as Je,p as ue,a as v,s as ee,b as N,u as fe,o as Le,c as We,g as S,e as R,f as Ye,i as U,t as J,h as O,j as ge,k as K,l as Y,m as Z,n as F,q as ye,r as V,v as ze,w as H,x as xe,y as ae,z as oe,A as Ce,B as p,C as Xe,D as we,E as Ke,F as te,G as Ge,H as Ae,I as pe,J as Fe,K as X,L as Ve,M as be,N as Ee,O as Re,P as $e}from"./external.CGBwoJrC.js";const et="modulepreload",tt=function(s){return"/svelte-treeviews/"+s},Ne={},nt=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.all(t.map(o=>{if(o=tt(o),o in Ne)return;Ne[o]=!0;const a=o.endsWith(".css"),f=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${f}`))return;const m=document.createElement("link");if(m.rel=a?"stylesheet":et,a||(m.as="script",m.crossOrigin=""),m.href=o,l&&m.setAttribute("nonce",l),document.head.appendChild(m),a)return new Promise((u,P)=>{m.addEventListener("load",u),m.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${o}`)))})}))}return r.then(()=>e()).catch(i=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i})};Je(["click"]);class it{constructor(e,t,n,r){_(this,"model");_(this,"modelCount");_(this,"itemSize");_(this,"estimatedItemSize");_(this,"itemSizeAndPositionData");_(this,"lastMeasuredIndex");_(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=r,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),r=e;e+=n,this.itemSizeAndPositionData[t]={offset:r,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const i=this.getSize(r);if(i===void 0||isNaN(i))throw Error(`Invalid size returned for index ${r} of value ${i}`);this.itemSizeAndPositionData[r]={offset:n,size:i},n+=i}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=he.START,t,n,r){if(t<=0)return 0;const i=this.getSizeAndPositionForIndex(r),l=i.offset,o=l-t+i.size;let a;switch(e){case he.END:a=o;break;case he.CENTER:a=l-(t-i.size)/2;break;case he.START:a=l;break;default:a=Math.max(o,Math.min(l,n))}const f=this.getTotalSize();return Math.max(0,Math.min(f-t,a))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const i=t+e;let l=this.findNearestItem(t);if(l===void 0)throw Error(`Invalid offset ${t} specified`);const o=this.getSizeAndPositionForIndex(l);t=o.offset+o.size;let a=l;for(;t<i&&a<this.modelCount-1;)a++,t+=this.getSizeAndPositionForIndex(a).size;return n&&(l=Math.max(0,l-n),a=Math.min(a+n,this.modelCount-1)),{start:l,end:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let r=0,i=0;for(;e<=t;){if(r=e+Math.floor((t-e)/2),i=this.getSizeAndPositionForIndex(r).offset,i===n)return r;i<n?e=r+1:i>n&&(t=r-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}var st=K('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');const rt=(()=>{let s=!1;try{const e=Object.defineProperty({},"passive",{get(){return s={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return s})();function lt(s,e){ue(e,!0);const t=v(e,"width",3,"100%"),n=v(e,"model",19,()=>[]),r=v(e,"windowOverPadding",3,3),i=v(e,"scrollDirection",19,()=>L.VERTICAL),l=v(e,"scrollToAlignment",19,()=>he.AUTO),o=v(e,"scrollToBehaviour",19,()=>He.INSTANT),a=v(e,"class",3,"");v(e,"style",3,"");const f={[L.VERTICAL]:"top",[L.HORIZONTAL]:"left"},m={[L.VERTICAL]:"scrollTop",[L.HORIZONTAL]:"scrollLeft"},u=new it(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let P=!1,b,k=ee(N([])),h=ee(N({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&B(e.scrollToIndex)||0,scrollChangeReason:ce.REQUESTED})),y={},z={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},g={},T=ee(""),x=ee("");fe(()=>{e.scrollToIndex,l(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,M()}),fe(()=>{S(h),A()}),fe(()=>{e.height,t(),P&&D(0)}),(()=>{if(i()===L.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(i()===L.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());I()})(),Le(()=>{b.addEventListener("scroll",de,rt),e.scrollOffset!==void 0?C(e.scrollOffset):e.scrollToIndex!==void 0&&C(B(e.scrollToIndex)),P=!0}),We(()=>{P&&b.removeEventListener("scroll",de)});function M(){if(!P)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const d=z.scrollToIndex!==e.scrollToIndex||z.scrollToAlignment!==l(),c=z.modelCount!==e.modelCount||z.itemSize!==e.itemSize||z.estimatedItemSize!==e.estimatedItemSize;c&&(u.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),D()),z.scrollOffset!==e.scrollOffset?R(h,N({offset:e.scrollOffset||0,scrollChangeReason:ce.REQUESTED})):typeof e.scrollToIndex=="number"&&(d||c)&&R(h,N({offset:B(e.scrollToIndex,l(),e.modelCount),scrollChangeReason:ce.REQUESTED})),z={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function A(){if(!P)return;const{offset:d,scrollChangeReason:c}=S(h);(y.offset!==d||y.scrollChangeReason!==c)&&I(),y.offset!==d&&c===ce.REQUESTED&&C(d),y=S(h)}function I(){if(n().length===0||e.isDisabled)return;const{offset:d}=S(h);let{start:c,end:E}=u.getVisibleRange(i()===L.VERTICAL?e.height:t(),d,r()),j=[];const Q=u.getTotalSize(),re=typeof e.height=="number"?"px":"",le=typeof t()=="number"?"px":"";if(i()===L.VERTICAL?(R(T,`height:${e.height}${re};width:${t()}${le};`),R(x,`flex-direction:column;height:${Q}px;`)):(R(T,`height:${e.height}${re};width:${t()}${le};`),R(x,`min-height:100%;width:${Q}px;`)),n()&&c!==void 0&&E!==void 0){for(let q=c;q<=E;(q+=1)-1)j.push({item:n()[q],index:q,style:_e(q)});if(e.onVisibleRangeUpdate){const q=u.getVisibleRange(i()===L.VERTICAL?e.height:t(),d,0);e.onVisibleRangeUpdate({type:"range.update",start:q.start,end:q.end})}}R(k,N(j))}function C(d){"scroll"in b?b.scroll({[f[i()]]:d,behavior:o()}):b[m[i()]]=d}function D(d=0){g={},u.resetItem(d),I()}function B(d,c=l(),E=e.modelCount){return d<0?d=0:d>=E&&(d=E-1),u.getUpdatedOffsetForIndex(c,i()===L.VERTICAL?e.height:t(),S(h).offset||0,d)}const de=d=>{const c=b[m[i()]];c<0||S(h).offset===c||d.target!==b||(R(h,N({offset:c,scrollChangeReason:ce.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:c,event:d}))};function _e(d){if(g[d])return g[d];const{size:c,offset:E}=u.getSizeAndPositionForIndex(d),j=i()===L.VERTICAL?`left:0;width:100%;height:${c}px;position:absolute;top:${E}px;`:`top:0;width:${c}px;position:absolute;height:100%;left:${E}px;`;return g[d]=j}var w=st();Ye(w,d=>b=d,()=>b);var ne=V(w);U(ne,()=>e.header,d=>{var c=Z(),E=F(c);oe(E,()=>e.header),O(d,c)});var W=Y(ne,2),ie=V(W);U(ie,()=>e.isDisabled,d=>{var c=Z(),E=F(c);ye(E,17,n,ze,(j,Q,re)=>{var le=Z(),q=F(le);oe(q,()=>e.vl_slot,()=>({item:S(Q),style:"",index:re})),O(j,le)}),O(d,c)},d=>{var c=Z(),E=F(c);ye(E,17,()=>S(k),ze,(j,Q)=>{var re=Z(),le=F(re);oe(le,()=>e.vl_slot,()=>({item:S(Q).item,style:S(Q).style,index:S(Q).index})),O(j,re)}),O(d,c)}),H(W);var se=Y(W,2);return U(se,()=>e.footer,d=>{var c=Z(),E=F(c);oe(E,()=>e.footer),O(d,c)}),H(w),J(()=>{xe(w,`virtual-list-wrapper $${a()??""} svelte-f32i87`),ae(w,"style",S(T)),ae(W,"style",S(x))}),O(s,w),ge({recomputeSizes:D})}var He=(s=>(s.AUTO="auto",s.SMOOTH="smooth",s.INSTANT="instant",s))(He||{}),he=(s=>(s.AUTO="auto",s.START="start",s.CENTER="center",s.END="end",s))(he||{}),L=(s=>(s.HORIZONTAL="horizontal",s.VERTICAL="vertical",s))(L||{}),ce=(s=>(s[s.OBSERVED=0]="OBSERVED",s[s.REQUESTED=1]="REQUESTED",s))(ce||{}),ot=K('<div class="tree-line tree-vline svelte-gfld7i"></div>'),at=K('<div class="tree-line tree-hline svelte-gfld7i"></div>'),dt=K("<!> <!>",1),ct=K('<div><!> <div class="tree-node-inner"><!></div></div>');function ht(s,e){ue(e,!0);let t=v(e,"rtl",3,!1),n=v(e,"btt",3,!1),r=v(e,"indent",3,20),i=v(e,"treeLine",3,!0),l=v(e,"treeLineOffset",3,10),o=v(e,"class",3,""),a=v(e,"style",3,""),f=p(()=>`${t()?"paddingRight":"paddingLeft"}:${r()*(e.nodeInfo.level-1)}px`),m=p(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*r()+l()}px`);fe(()=>{var T,x;const g=e.nodeInfo.expended;console.log("toggleOpen"),!u&&(g?(T=e.onNodeOpened)==null||T.call(e,e.nodeInfo):(x=e.onNodeclosed)==null||x.call(e,e.nodeInfo),P())}),fe(()=>{var g,T;e.nodeInfo.checked,!u&&(g=e.processor)!=null&&g.afterOneCheckChanged(e.nodeInfo)&&((T=e.onNodeChecked)==null||T.call(e,e.nodeInfo))});let u=!1;const P=()=>{u=!0,setTimeout(()=>{u=!1},100)},b=p(()=>{const g=[],T=I=>{var C;if(I.parent){let D=(C=I.parent)==null?void 0:C.children.indexOf(I);do{D+=1;const B=I.parent.children[D];if(B){if(!B.hidden)return!0}else break}while(!0)}return!1},x=t()?"right":"left",M=n()?"top":"bottom";let A=e.nodeInfo;for(;A;){const I=(A.level-2)*r()+l(),C=T(A),D=()=>{g.push({style:`${x}:${I}px;${M}:${C?"0":"50%"}`})};A===e.nodeInfo?A.level>1&&D():C&&D(),A=A.parent}return g});var k=ct();J(()=>xe(k,`${Ce("tree-node",o(),i()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var h=V(k);U(h,i,g=>{var T=dt(),x=F(T);ye(x,17,()=>S(b),ze,(A,I)=>{var C=ot();J(()=>ae(C,"style",S(I).style)),O(A,C)});var M=Y(x,2);U(M,()=>e.nodeInfo.level>1,A=>{var I=at();J(()=>ae(I,"style",S(m))),O(A,I)}),O(g,T)});var y=Y(h,2),z=V(y);oe(z,()=>e.tn_slot,()=>({data:e.nodeInfo.nodeData,info:e.nodeInfo})),H(y),H(k),J(()=>ae(k,"style",`${a()} ${S(f)}`)),O(s,k),ge()}function Oe(s){return Object.prototype.toString.call(s)==="[object Array]"}function ft(s){return s[s.length-1]}function ut(s,e){let t,n=0;for(;(t=s.indexOf(e))>-1;)s.splice(t,1),n++;return n}function gt(s,e,t){s.hasOwnProperty(e)||(s[e]=t)}function vt(s,e){return Object.keys(e).forEach(t=>{gt(s,t,e[t])}),s}function mt(s){const e={};return Object.keys(s).forEach(t=>{s[t]!==void 0&&(e[t]=s[t])}),e}function G(s,e,t={}){t=vt({...t},{childrenKey:"children"});const n=t.childrenKey,r=Oe(s)?s:[s];class i{}const l=(o,a,f)=>{t.reverse&&(o=o.slice(),o.reverse());const m=o.length;for(let u=0;u<m;u++){const P=o[u],b=t.reverse?m-u-1:u,k=f?[...f,b]:[];t.childFirst&&P[n]!=null&&l(P[n],P,k);const h=e(P,b,a,k);if(h===!1)throw new i;if(h==="skip children")continue;if(h==="skip siblings")break;t.childFirst||P[n]!=null&&l(P[n],P,k)}};try{l(r,null,Oe(s)?[]:null)}catch(o){if(!(o instanceof i))throw o}}function It(s,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,r=t.nodeHandler,i=new Pe;return i.childrenKey=n,G(s,(l,o,a,f)=>{let m=Object.assign({},l);m[n]&&(m[n]=[]),r&&(m=r(m,{oldNode:l,index:o,parent:a,path:f})),i.set(f,m)},{childrenKey:n}),i.data}class Pe{constructor(e=[]){_(this,"data");_(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return Oe(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:r}=this;if(t.reverse){const i=[...this.iteratePath(e,{...t,reverse:!1})];i.reverse();for(const{path:l,node:o}of i)yield{path:l,node:o}}else{let i=[],l=r;for(const o of e){const a=[...i,o],f=l[o];yield{path:a,node:f},i=a,l=f[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return ft(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:r}=this;const{parent:i,index:l}=this.getParentAndIndex(e);let o;e.length===1?(r||(this.data?this.data[n]=[]:this.data=[]),o=r):(i[n]||(i[n]=[]),o=i[n]),o[l]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:r,index:i}=this.getParentAndIndex(e),l=e.length===1?n:r[t],o=l[i];return l.splice(i,1),o}walk(e,t){const{childrenKey:n,data:r}=this;return G(r,e,n)}clone(e={}){return It(this.data),mt({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}class me{constructor(e){_(this,"nodeData");_(this,"expended");_(this,"parent");_(this,"children");_(this,"level");_(this,"hidden");_(this,"checked");_(this,"draggable");_(this,"droppable");_(this,"style");_(this,"class");_(this,"_ignoreCheckedOnce");this.nodeData=(e==null?void 0:e.nodeData)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=(e==null?void 0:e.style)||null,this.class=(e==null?void 0:e.class)||null,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}class Ue{constructor(e){_(this,"childrenKey",$);_(this,"defaultOpen",!1);_(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||$,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}afterSetInfoNode(e,t,n){}afterRemoveInfoNode(e){}infoHandler(e){return e}}class St extends Ue{constructor(t){super(t);_(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=N(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=N(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=N(t);return this.filter(super.InfoNodesFlatHandler,n)}}const $="children";var Ie,Se;class xt{constructor(e){_(this,"nodeData");Te(this,Ie,ee(N([])));Te(this,Se,ee(N([])));_(this,"_infosMap");_(this,"options");_(this,"initialized",!1);this._infosMap=null,this.options=e||new Ue}get nodeInfos(){return S(ve(this,Ie))}set nodeInfos(e){R(ve(this,Ie),N(e))}get nodeInfosToRender(){return S(ve(this,Se))}set nodeInfosToRender(e){R(ve(this,Se),N(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new Pe([]);this._infosMap=new Map,G(this.nodeData,(r,i,l,o)=>{const a=this.options.infoHandler(new me({nodeData:r,expended:!!this.options.defaultOpen,parent:t.getParent(o),children:[],level:o.length}));this._infosMap.set(r,a),t.set(o,a)},{childrenKey:e}),console.log("td",t),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren);const n=[];t.walk(r=>{n.push(r)}),console.log("rootChildren",t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new De("NodeInfo not found");return t}has(e){if(e instanceof me)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof De)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=r=>{const i=r.parent;if(i){let l=!1,o=!1;for(const f of i.children)if(f.checked||f.checked===0)l=!0;else if(o=!0,l&&o)break;const a=o?l?0:!1:!0;i.checked!==a&&(this._ignoreCheckedOnce(i),i.checked=a),n(i)}};return n(e),G(e.children,r=>{r.checked!==t&&(this._ignoreCheckedOnce(r),r.checked=t)},{childrenKey:$}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof me?e:this.getNodeInfo(e),n=r=>!r||!r.hidden&&r.expended&&n(r.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){G(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:$})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof me?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const r=e?e.children:this.nodeInfos;for(let i=0;i<t;(i+=1)-1)n+=this._count(r[i]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const r=t?t.children:this.nodeInfos;n==null&&(n=r.length);const i=this.options.infoHandler(new me({expended:!!this.options.defaultOpen,nodeData:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(i,t||null,n);const l=e[this.childrenKey];if(l){const o=l.slice();for(const a of o)this.add(a,i)}}remove(e){const t=this.getSiblings(e);if(t.includes(e)){ut(t,e);const n=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),n.length);for(const r of n)this._infosMap.delete(r.nodeData);return this.options.afterRemoveInfoNode(e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const i=this._calcFlatIndex(t,n),l=this._flat(e);this.nodeInfosToRender.splice(i,0,...l);for(const o of l)this._infosMap.has(o.nodeData)||this._infosMap.set(o.nodeData,o);G(e,(o,a,f)=>{f&&(o.level=f.level+1)},{childrenKey:$}),this.options.afterSetInfoNode(e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let r;for(const i of this.iterateParent(t))if(i.level===e.level){r=i;break}if(e===r)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return G(e,n=>{t.push(n)},{childrenKey:$}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,r=new Pe([]);return r.childrenKey=n,G(t||this.nodeInfos,(i,l,o,a)=>{let f={...i.nodeData,[n]:[]};e&&(f=e(f)),r.set(a,f)},{childrenKey:$}),r.data}}Ie=new WeakMap,Se=new WeakMap;class De extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}function _t(s,e){const t=new St(e),n=new xt(t);return t.noInitialization||n.init(),n}var yt=K('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function Rt(s,e){ue(e,!0);let t=v(e,"processor",23,()=>_t([],{noInitialization:!0}));v(e,"updateBehavior",3,"modify"),v(e,"childrenKey",3,$),v(e,"textKey",3,"text");let n=v(e,"indent",3,20),r=v(e,"virtualization",3,!1);v(e,"virtualizationPrerenderCount",3,20),v(e,"defaultOpen",3,!0);let i=v(e,"rtl",3,!1),l=v(e,"btt",3,!1);v(e,"nodeKey",3,"index");let o=v(e,"treeLine",3,!1),a=v(e,"treeLineOffset",3,8);v(e,"class",3,"");let f=v(e,"style",3,""),m=ee(N([])),u=null,P=!1,b={};fe(()=>{e.model,console.log("model change detected"),console.log("Initializing model"),t().nodeData=e.model,t().init(),R(m,N(t().nodeInfosToRender))});function k(){let x=S(m)||[];return l()&&(x=x.slice().reverse()),x.filter(M=>h(M))}function h(x){return t().isVisible(x)}var y=p(()=>Ce("he-tree",i()&&"he-tree--rtl rtl",P)),z=p(()=>!r()),g=p(k),T=p(()=>{var x;return((x=t().nodeInfos)==null?void 0:x.length)||0});lt(s,{get class(){return S(y)},get style(){return f()},height:500,get isDisabled(){return S(z)},width:"auto",get model(){return S(g)},get modelCount(){return S(T)},itemSize:25,vl_slot:(M,A)=>{let I=()=>A==null?void 0:A().item;var C=Z(),D=F(C);U(D,I,B=>{var de=p(()=>Ce(I().class,{"drag-placeholder-wrapper":I().nodeData===b,"dragging-node":I()===u}));ht(B,{get class(){return S(de)},get style(){return I().style},get nodeInfo(){return I()},get rtl(){return i()},get btt(){return l()},get indent(){return n()},get treeLine(){return o()},get treeLineOffset(){return a()},get processor(){return t()},onNodeOpened:w=>e.onNodeOpened&&e.onNodeOpened(w),onNodeclosed:w=>e.onNodeClosed&&e.onNodeClosed(w),onNodeChecked:w=>e.onNodeChecked&&e.onNodeChecked(w),tn_slot:(w,ne=Xe)=>{var W=Z(),ie=F(W);U(ie,()=>ne().data===b,se=>{var d=yt(),c=V(d);U(c,()=>e.placeholder,E=>{var j=Z(),Q=F(j);oe(Q,()=>e.placeholder),O(E,j)}),H(d),O(se,d)},se=>{var d=Z(),c=F(d);oe(c,()=>e.tree_slot,ne),O(se,d)}),O(w,W)}})}),O(M,C)}}),ge()}var zt=K("<div></div>");function Me(s,e){ue(e,!0);const t=we(),{getDragged:n}=Ke("dragging");let r=ee(!1);function i(u){return 1}function l(u){!u.target||!u.target.id||(i(u.target.id),R(r,!0))}function o(u){!u.target||!u.target.id||(i(u.target.id)>0&&t("drop",{oldPosition:n(),newPosition:u.target.id.split("-")}),a())}function a(){R(r,!1)}function f(){return`dropzone-${e.prefix}`}var m=zt();J(()=>ae(m,"id",f())),J(()=>xe(m,`${`dropzone ${S(r)?"active":"idle"}`??""} svelte-1n7j4p5`)),te("dragleave",m,()=>a()),te("dragenter",m,u=>l(u)),te("drop",m,u=>o(u)),te("dragover",m,()=>!1),O(s,m),ge()}var Tt=K("<span> </span>");function Be(s,e){var t=Tt(),n=V(t);H(t),J(()=>{xe(t,`${`clickable ${e.isLeafNode?"isLeafNode":""}`??""} svelte-13dhc3a`),Ge(n,e.label)}),O(s,t)}const Ct=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"}));var bt=K("<i></i>"),Ot=K('<li class="svelte-1bsomvo"><!></li>'),Pt=K('<ul class="svelte-1bsomvo"><!> <li class="svelte-1bsomvo"><!></li></ul>'),wt=K('<!> <div draggable="true"><!> <div class="node-wrapper svelte-1bsomvo"><!></div></div> <!>',1);function je(s,e){ue(e,!1);const t=be(),n=be(),r=we();Ke("dragging");let i=v(e,"expanded",12,!1),l=v(e,"children",8),o=v(e,"label",8),a=v(e,"prefix",8,null),f=v(e,"internalOptions",8);v(e,"data",8,null);function m(){i(!i())}function u(){r("selected",`${a()}`.split("-"))}function P(){}function b(I){!I.target||!I.target.id||r("dragstart",I.target.id.split("-"))}function k(I){return a()!==null?`${a()}-${I}`:I}Ae(()=>Ee(l()),()=>{R(t,!Array.isArray(l()))}),Ae(()=>Ee(a()),()=>{R(n,a()===null)}),pe(),Fe();var h=wt(),y=F(h);U(y,()=>!S(n),I=>{Me(I,{get prefix(){return a()},$$events:{drop(C){X.call(this,e,C)}}})});var z=Y(y);z.nodeValue="  ";var g=Y(z),T=V(g);U(T,()=>!S(t),I=>{var C=bt();J(()=>xe(C,`${`clickable toggle-icon ${i()?f().collapseClass:f().expandClass}`??""} svelte-1bsomvo`)),te("click",C,()=>m()),O(I,C)});var x=Y(T,2),M=V(x);Be(M,{get label(){return o()},get isLeafNode(){return S(t)}}),H(x),H(g);var A=Y(g,2);U(A,()=>i()&&!S(t),I=>{var C=Pt(),D=V(C);ye(D,1,l,ze,(w,ne,W)=>{var ie=Ot(),se=V(ie),d=Re(()=>k(W));je(se,Ve(()=>S(ne),{get internalOptions(){return f()},get expanded(){return i()},get prefix(){return S(d)},$$events:{selected(c){X.call(this,e,c)},dragenter(c){X.call(this,e,c)},dragleave(c){X.call(this,e,c)},dragstart(c){X.call(this,e,c)},dragend(c){X.call(this,e,c)},drop(c){X.call(this,e,c)}}})),H(ie),O(w,ie)});var B=Y(D,2),de=V(B),_e=Re(()=>{var w;return k((w=l())==null?void 0:w.length)});Me(de,{get prefix(){return S(_e)},$$events:{drop(w){X.call(this,e,w)}}}),H(B),H(C),O(I,C)}),J(()=>ae(g,"id",a())),te("dragstart",g,I=>b(I)),te("dragend",g,()=>void 0),te("click",x,()=>u()),O(s,h),ge()}var kt=K('<div class="tree"><!></div>');function Nt(s,e){ue(e,!1);const t=we();let n=v(e,"treeItems",8),r=v(e,"options",8),i=be({labelFormatter:()=>nt(()=>Promise.resolve().then(()=>Ct),void 0),collapseClass:"chevron bottom",expandClass:"chevron right"});Le(async()=>{R(i,Object.assign(S(i),r()))});let l;$e("dragging",{getDragged:()=>l});function o(h){t("selected",f(h.slice(),n()))}function a(h){l=h.detail}function f(h,y){if(h.length===0)return y;const z=h.shift(),g=y.children[z];return g.hasOwnProperty("children")?f(h,g):g}function m(h,y){var z=[],g;for(g=0;g<h.length;(g+=1)-1)h[g]===y&&z.push(g);return z}function u(h,y,z,g){if(h!==y)return h.children.indexOf(g);const T=m(h.children,g);if(T.length!==2){console.error("found too few/too many indexes",T);return}return T.find(x=>`${x}`!=`${z.slice().pop()}`)}function P(h){const y=h.detail.oldPosition.slice(),z=h.detail.newPosition.slice(1),g=f(y.slice(0,y.length-1),n()),T=f(z.slice(0,z.length-1),n()),x=f(y.slice(),n());T.children.splice(z.slice().pop(),0,x);const M=u(g,T,z.slice(),x);g.children.splice(M,1),l=null,t("modelChanged",n())}Fe();var b=kt(),k=V(b);U(k,n,h=>{je(h,Ve(n,{get internalOptions(){return S(i)},expanded:!0,$$events:{selected:y=>o(y.detail),dragstart:y=>a(y),drop:P}}))}),H(b),O(s,b),ge()}export{Rt as T,nt as _,Nt as a};
