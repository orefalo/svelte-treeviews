var Xe=Object.defineProperty;var Fe=i=>{throw TypeError(i)};var Ge=(i,e,t)=>e in i?Xe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var x=(i,e,t)=>Ge(i,typeof e!="symbol"?e+"":e,t),pe=(i,e,t)=>e.has(i)||Fe("Cannot "+t);var T=(i,e,t)=>(pe(i,e,"read from private field"),t?t.call(i):e.get(i)),H=(i,e,t)=>e.has(i)?Fe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import{d as $e,p as Ae,a as g,s as R,b as m,u as de,o as et,c as tt,g as c,e as C,f as Ue,i as q,t as le,h as b,j as Pe,k as J,l as ce,m as B,n as L,q as Oe,r as ee,v as Ee,w as te,x as Be,y as ae,z as ne,A as Ne,B as Y,C as nt,D as it,E as st,F as Ve,G as rt,H as lt,I as ot}from"./external.iwCWfrb3.js";$e(["click"]);class dt{constructor(e,t,n,s){x(this,"model");x(this,"modelCount");x(this,"itemSize");x(this,"estimatedItemSize");x(this,"itemSizeAndPositionData");x(this,"lastMeasuredIndex");x(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=s,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),s=e;e+=n,this.itemSizeAndPositionData[t]={offset:s,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let s=this.lastMeasuredIndex+1;s<=e;s++){const r=this.getSize(s);if(r===void 0||isNaN(r))throw Error(`Invalid size returned for index ${s} of value ${r}`);this.itemSizeAndPositionData[s]={offset:n,size:r},n+=r}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=oe.START,t,n,s){if(t<=0)return 0;const r=this.getSizeAndPositionForIndex(s),l=r.offset,o=l-t+r.size;let a;switch(e){case oe.END:a=o;break;case oe.CENTER:a=l-(t-r.size)/2;break;case oe.START:a=l;break;default:a=Math.max(o,Math.min(l,n))}const v=this.getTotalSize();return Math.max(0,Math.min(v-t,a))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const r=t+e;let l=this.findNearestItem(t);if(l===void 0)throw Error(`Invalid offset ${t} specified`);const o=this.getSizeAndPositionForIndex(l);t=o.offset+o.size;let a=l;for(;t<r&&a<this.modelCount-1;)a++,t+=this.getSizeAndPositionForIndex(a).size;return n&&(l=Math.max(0,l-n),a=Math.min(a+n,this.modelCount-1)),{start:l,end:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let s=0,r=0;for(;e<=t;){if(s=e+Math.floor((t-e)/2),r=this.getSizeAndPositionForIndex(s).offset,r===n)return s;r<n?e=s+1:r>n&&(t=s-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}const at=(()=>{let i=!1;try{const e=Object.defineProperty({},"passive",{get(){return i={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return i})();var ct=J('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');function ht(i,e){Ae(e,!0);const t=g(e,"width",3,"100%"),n=g(e,"model",19,()=>[]),s=g(e,"windowOverPadding",3,3),r=g(e,"scrollDirection",19,()=>F.VERTICAL),l=g(e,"scrollToAlignment",19,()=>oe.AUTO),o=g(e,"scrollToBehaviour",19,()=>je.INSTANT),a=g(e,"class",3,"");g(e,"style",3,"");const v={[F.VERTICAL]:"top",[F.HORIZONTAL]:"left"},O={[F.VERTICAL]:"scrollTop",[F.HORIZONTAL]:"scrollLeft"},I=new dt(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let u=!1,A,K=R(m([])),y=R(m({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&ie(e.scrollToIndex)||0,scrollChangeReason:re.REQUESTED})),w={},z={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},E={},N=R(""),_=R("");de(()=>{e.scrollToIndex,l(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,P()}),de(()=>{c(y),V()}),de(()=>{e.height,t(),u&&he(0)}),(()=>{if(r()===F.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(r()===F.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());U()})(),et(()=>{A.addEventListener("scroll",_e,at),e.scrollOffset!==void 0?W(e.scrollOffset):e.scrollToIndex!==void 0&&W(ie(e.scrollToIndex)),u=!0}),tt(()=>{u&&A.removeEventListener("scroll",_e)});function P(){if(!u)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const d=z.scrollToIndex!==e.scrollToIndex||z.scrollToAlignment!==l(),h=z.modelCount!==e.modelCount||z.itemSize!==e.itemSize||z.estimatedItemSize!==e.estimatedItemSize;h&&(I.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),he()),z.scrollOffset!==e.scrollOffset?C(y,m({offset:e.scrollOffset||0,scrollChangeReason:re.REQUESTED})):typeof e.scrollToIndex=="number"&&(d||h)&&C(y,m({offset:ie(e.scrollToIndex,l(),e.modelCount),scrollChangeReason:re.REQUESTED})),z={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function V(){if(!u)return;const{offset:d,scrollChangeReason:h}=c(y);(w.offset!==d||w.scrollChangeReason!==h)&&U(),w.offset!==d&&h===re.REQUESTED&&W(d),w=c(y)}function U(){if(n().length===0||e.isDisabled)return;const{offset:d}=c(y);let{start:h,end:k}=I.getVisibleRange(r()===F.VERTICAL?e.height:t(),d,s()),Q=[];const Z=I.getTotalSize(),G=typeof e.height=="number"?"px":"",M=typeof t()=="number"?"px":"";if(r()===F.VERTICAL?(C(N,`height:${e.height}${G};width:${t()}${M};`),C(_,`flex-direction:column;height:${Z}px;`)):(C(N,`height:${e.height}${G};width:${t()}${M};`),C(_,`min-height:100%;width:${Z}px;`)),n()&&h!==void 0&&k!==void 0){for(let S=h;S<=k;(S+=1)-1)Q.push({item:n()[S],index:S,style:ke(S)});if(e.onVisibleRangeUpdate){const S=I.getVisibleRange(r()===F.VERTICAL?e.height:t(),d,0);e.onVisibleRangeUpdate({type:"range.update",start:S.start,end:S.end})}}C(K,m(Q))}function W(d){"scroll"in A?A.scroll({[v[r()]]:d,behavior:o()}):A[O[r()]]=d}function he(d=0){E={},I.resetItem(d),U()}function ie(d,h=l(),k=e.modelCount){return d<0?d=0:d>=k&&(d=k-1),I.getUpdatedOffsetForIndex(h,r()===F.VERTICAL?e.height:t(),c(y).offset||0,d)}const _e=d=>{const h=A[O[r()]];h<0||c(y).offset===h||d.target!==A||(C(y,m({offset:h,scrollChangeReason:re.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:h,event:d}))};function ke(d){if(E[d])return E[d];const{size:h,offset:k}=I.getSizeAndPositionForIndex(d),Q=r()===F.VERTICAL?`left:0;width:100%;height:${h}px;position:absolute;top:${k}px;`:`top:0;width:${h}px;position:absolute;height:100%;left:${k}px;`;return E[d]=Q}var X=ct();Ue(X,d=>A=d,()=>A);var be=ee(X);q(be,()=>e.header,d=>{var h=B(),k=L(h);ne(k,()=>e.header),b(d,h)});var f=ce(be,2),D=ee(f);q(D,()=>e.isDisabled,d=>{var h=B(),k=L(h);Oe(k,17,n,Ee,(Q,Z,G)=>{var M=B(),S=L(M);ne(S,()=>e.vl_slot,()=>({item:c(Z),style:"",index:G})),b(Q,M)}),b(d,h)},d=>{var h=B(),k=L(h);Oe(k,17,()=>c(K),Ee,(Q,Z)=>{var G=B(),M=L(G);ne(M,()=>e.vl_slot,()=>({item:c(Z).item,style:c(Z).style,index:c(Z).index})),b(Q,G)}),b(d,h)}),te(f);var j=ce(f,2);return q(j,()=>e.footer,d=>{var h=B(),k=L(h);ne(k,()=>e.footer),b(d,h)}),te(X),le(()=>{Be(X,`virtual-list-wrapper $${a()??""} svelte-f32i87`),ae(X,"style",c(N)),ae(f,"style",c(_))}),b(i,X),Pe({recomputeSizes:he})}var je=(i=>(i.AUTO="auto",i.SMOOTH="smooth",i.INSTANT="instant",i))(je||{}),oe=(i=>(i.AUTO="auto",i.START="start",i.CENTER="center",i.END="end",i))(oe||{}),F=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(F||{}),re=(i=>(i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED",i))(re||{}),ft=J('<div class="tree-line tree-vline svelte-gfld7i"></div>'),ut=J('<div class="tree-line tree-hline svelte-gfld7i"></div>'),gt=J("<!> <!>",1),mt=J('<div><!> <div class="tree-node-inner"><!></div></div>');function vt(i,e){Ae(e,!0);let t=g(e,"rtl",3,!1),n=g(e,"btt",3,!1),s=g(e,"indent",3,20),r=g(e,"treeLine",3,!0),l=g(e,"treeLineOffset",3,10),o=Y(()=>`${t()?"paddingRight":"paddingLeft"}:${s()*(e.nodeInfo.level-1)}px`),a=Y(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*s()+l()}px`);de(()=>{var w,z;e.nodeInfo.checked,!v&&(w=e.processor)!=null&&w.afterOneCheckChanged(e.nodeInfo)&&((z=e.onNodeChecked)==null||z.call(e,e.nodeInfo))}),de(()=>{var z,E;const w=e.nodeInfo.expended;console.log("toggleOpen"),!v&&(w?(z=e.onNodeOpened)==null||z.call(e,e.nodeInfo):(E=e.onNodeClosed)==null||E.call(e,e.nodeInfo),O())});let v=!1;const O=()=>{v=!0,setTimeout(()=>{v=!1},100)},I=Y(()=>{const w=[],z=P=>{var V;if(P.parent){let U=(V=P.parent)==null?void 0:V.children.indexOf(P);do{U+=1;const W=P.parent.children[U];if(W){if(!W.hidden)return!0}else break}while(!0)}return!1},E=t()?"right":"left",N=n()?"top":"bottom";let _=e.nodeInfo;for(;_;){const P=(_.level-2)*s()+l(),V=z(_),U=()=>{w.push({style:`${E}:${P}px;${N}:${V?"0":"50%"}`})};_===e.nodeInfo?_.level>1&&U():V&&U(),_=_.parent}return w});var u=mt();le(()=>Be(u,`${Ne("tree-node",e.class,r()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var A=ee(u);q(A,r,w=>{var z=gt(),E=L(z);Oe(E,17,()=>c(I),Ee,(_,P)=>{var V=ft();le(()=>ae(V,"style",c(P).style)),b(_,V)});var N=ce(E,2);q(N,()=>e.nodeInfo.level>1,_=>{var P=ut();le(()=>ae(P,"style",c(a))),b(_,P)}),b(w,z)});var K=ce(A,2),y=ee(K);ne(y,()=>e.tn_slot,()=>({data:e.nodeInfo.data,info:e.nodeInfo})),te(K),te(u),le(()=>ae(u,"style",`${e.style} ${c(o)}`)),b(i,u),Pe()}function Me(i){return Object.prototype.toString.call(i)==="[object Array]"}function It(i){return i[i.length-1]}function Qe(i,e){let t,n=0;for(;(t=i.indexOf(e))>-1;)i.splice(t,1),n++;return n}function St(i,e,t){i.hasOwnProperty(e)||(i[e]=t)}function zt(i,e){return Object.keys(e).forEach(t=>{St(i,t,e[t])}),i}function yt(i){const e={};return Object.keys(i).forEach(t=>{i[t]!==void 0&&(e[t]=i[t])}),e}function p(i,e,t={}){t=zt({...t},{childrenKey:"children"});const n=t.childrenKey,s=Me(i)?i:[i];class r{}const l=(o,a,v)=>{t.reverse&&(o=o.slice(),o.reverse());const O=o.length;for(let I=0;I<O;I++){const u=o[I],A=t.reverse?O-I-1:I,K=v?[...v,A]:[];t.childFirst&&u[n]!=null&&l(u[n],u,K);const y=e(u,A,a,K);if(y===!1)throw new r;if(y==="skip children")continue;if(y==="skip siblings")break;t.childFirst||u[n]!=null&&l(u[n],u,K)}};try{l(s,null,Me(i)?[]:null)}catch(o){if(!(o instanceof r))throw o}}function xt(i,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,s=t.nodeHandler,r=new De;return r.childrenKey=n,p(i,(l,o,a,v)=>{let O=Object.assign({},l);O[n]&&(O[n]=[]),s&&(O=s(O,{oldNode:l,index:o,parent:a,path:v})),r.set(v,O)},{childrenKey:n}),r.data}class De{constructor(e=[]){x(this,"data");x(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return Me(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:s}=this;if(t.reverse){const r=[...this.iteratePath(e,{...t,reverse:!1})];r.reverse();for(const{path:l,node:o}of r)yield{path:l,node:o}}else{let r=[],l=s;for(const o of e){const a=[...r,o],v=l[o];yield{path:a,node:v},r=a,l=v[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return It(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:s}=this;const{parent:r,index:l}=this.getParentAndIndex(e);let o;e.length===1?(s||(this.data?this.data[n]=[]:this.data=[]),o=s):(r[n]||(r[n]=[]),o=r[n]),o[l]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:s,index:r}=this.getParentAndIndex(e),l=e.length===1?n:s[t],o=l[r];return l.splice(r,1),o}walk(e,t){const{childrenKey:n,data:s}=this;return p(s,e,n)}clone(e={}){return xt(this.data),yt({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}var ue,ge,me,ve,Ie,Se,ze,ye;class fe{constructor(e){x(this,"data");H(this,ue,R(!1));H(this,ge,R(null));H(this,me,R(m([])));H(this,ve,R(0));H(this,Ie,R(!1));H(this,Se,R(!1));x(this,"draggable");x(this,"droppable");H(this,ze,R(""));H(this,ye,R(""));x(this,"_ignoreCheckedOnce");this.data=(e==null?void 0:e.data)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=e==null?void 0:e.style,this.class=e==null?void 0:e.class,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}get expended(){return c(T(this,ue))}set expended(e){C(T(this,ue),m(e))}get parent(){return c(T(this,ge))}set parent(e){C(T(this,ge),m(e))}get children(){return c(T(this,me))}set children(e){C(T(this,me),m(e))}get level(){return c(T(this,ve))}set level(e){C(T(this,ve),m(e))}get hidden(){return c(T(this,Ie))}set hidden(e){C(T(this,Ie),m(e))}get checked(){return c(T(this,Se))}set checked(e){C(T(this,Se),m(e))}get style(){return c(T(this,ze))}set style(e){C(T(this,ze),m(e))}get class(){return c(T(this,ye))}set class(e){C(T(this,ye),m(e))}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}ue=new WeakMap,ge=new WeakMap,me=new WeakMap,ve=new WeakMap,Ie=new WeakMap,Se=new WeakMap,ze=new WeakMap,ye=new WeakMap;const $="children";class Ze{constructor(e){x(this,"childrenKey",$);x(this,"defaultOpen",!1);x(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||$,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}infoHandler(e){return e}}var xe,Te,Ce;class Tt{constructor(e,t){x(this,"rawData");H(this,xe,R(m([])));H(this,Te,R(m([])));H(this,Ce,R(m(new Map)));x(this,"options");x(this,"afterSetInfoNode");x(this,"afterRemoveInfoNode");x(this,"initialized",!1);this.options=t||new Ze}get nodeInfos(){return c(T(this,xe))}set nodeInfos(e){C(T(this,xe),m(e))}get nodeInfosToRender(){return c(T(this,Te))}set nodeInfosToRender(e){C(T(this,Te),m(e))}get _infosMap(){return c(T(this,Ce))}set _infosMap(e){C(T(this,Ce),m(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new De([]);this._infosMap.clear(),p(this.rawData,(s,r,l,o)=>{const a=this.options.infoHandler(new fe({data:s,expended:this.options.defaultOpen,parent:t.getParent(o),children:[],level:o.length}));this._infosMap.set(s,a),t.set(o,a)},{childrenKey:e}),console.log("td",t);const n=[];t.walk(s=>{n.push(s)}),console.log("rootChildren",t.rootChildren),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new He("NodeInfo not found");return t}has(e){if(e instanceof fe)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof He)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=s=>{const r=s.parent;if(r){let l=!1,o=!1;for(const v of r.children)if(v.checked||v.checked===0)l=!0;else if(o=!0,l&&o)break;const a=o?l?0:!1:!0;r.checked!==a&&(this._ignoreCheckedOnce(r),r.checked=a),n(r)}};return n(e),p(e.children,s=>{s.checked!==t&&(this._ignoreCheckedOnce(s),s.checked=t)},{childrenKey:$}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof fe?e:this.getNodeInfo(e),n=s=>!s||!s.hidden&&s.expended&&n(s.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){p(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:$})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof fe?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const s=e?e.children:this.nodeInfos;for(let r=0;r<t;(r+=1)-1)n+=this._count(s[r]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const s=t?t.children:this.nodeInfos;n==null&&(n=s.length);const r=this.options.infoHandler(new fe({expended:!!this.options.defaultOpen,data:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(r,t||null,n);const l=e[this.childrenKey];if(l){const o=l.slice();for(const a of o)this.add(a,r)}}remove(e){var n;const t=this.getSiblings(e);if(t.includes(e)){Qe(t,e);const s=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),s.length);for(const r of s)this._infosMap.delete(r.data);return(n=this.afterRemoveInfoNode)==null||n.call(this,e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){var o;(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const r=this._calcFlatIndex(t,n),l=this._flat(e);this.nodeInfosToRender.splice(r,0,...l);for(const a of l)this._infosMap.has(a.data)||this._infosMap.set(a.data,a);p(e,(a,v,O)=>{O&&(a.level=O.level+1)},{childrenKey:$}),(o=this.afterSetInfoNode)==null||o.call(this,e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let s;for(const r of this.iterateParent(t))if(r.level===e.level){s=r;break}if(e===s)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return p(e,n=>{t.push(n)},{childrenKey:$}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,s=new De([]);return s.childrenKey=n,p(t||this.nodeInfos,(r,l,o,a)=>{let v={...r.data,[n]:[]};e&&(v=e(v)),s.set(a,v)},{childrenKey:$}),s.data}}xe=new WeakMap,Te=new WeakMap,Ce=new WeakMap;class He extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}class Ct extends Ze{constructor(t){super(t);x(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=m(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=m(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=m(t);return this.filter(super.InfoNodesFlatHandler,n)}}function _t(i,e){const t=new Ct(e),n=new Tt(i,t);return t.noInitialization||n.init(),n}var bt=J('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function Et(i,e){Ae(e,!0);let t=g(e,"processor",23,()=>_t([],{noInitialization:!0})),n=g(e,"updateBehavior",3,"modify"),s=g(e,"childrenKey",3,$);g(e,"textKey",3,"text");let r=g(e,"indent",3,20),l=g(e,"virtualization",3,!1);g(e,"virtualizationPrerenderCount",3,20),g(e,"defaultOpen",3,!0);let o=g(e,"rtl",3,!1),a=g(e,"btt",3,!1);g(e,"nodeKey",3,"index");let v=g(e,"treeLine",3,!1),O=g(e,"treeLineOffset",3,8);g(e,"class",3,"");let I=g(e,"style",3,"");const u=f=>f?(f[s()]||(f[s()]=[]),f[s()]):c(P);t().afterSetInfoNode=(f,D,j)=>{let d=c(P);if(n()==="new"){if(N)return;d=ie()}else if(n()==="modify"){const h=u(D==null?void 0:D.data);h.includes(f.data)||h.splice(j,0,f.data)}else n();N||W(d)},t().afterRemoveInfoNode=f=>{var j;let D=c(P);if(n()==="new"){if(N)return;D=ie()}else if(n()==="modify"){const d=u((j=f.parent)==null?void 0:j.data);Qe(d,f.data)}else n();N||W(D)};let A,K=R(m([])),y=R(m([])),w=null,z=!1,E={},N=!1,_=!1,P=Y(()=>e.model);de(()=>{console.log("model change detected"),_?_=!1:(console.log("Initializing model"),t().rawData=e.model,t().init(),C(K,m(t().nodeInfos)),C(y,m(t().nodeInfosToRender)))});function V(){let f=c(y)||[];return a()&&(f=f.slice(),f.reverse()),f.filter(D=>he(D))}function U(f){e.onUpdateValue&&e.onUpdateValue(f)}function W(f){return n()==="disabled"?!1:(f!==c(P)&&(_=!0),U(f),!0)}function he(f){return t().isVisible(f)}function ie(f,D){return t().getData(f,D)}var _e=Y(()=>Ne("he-tree",o()&&"he-tree--rtl rtl",z)),ke=Y(()=>!l()),X=Y(V),be=Y(()=>{var f;return((f=t().nodeInfos)==null?void 0:f.length)||0});Ue(ht(i,{get class(){return c(_e)},get style(){return I()},height:500,get isDisabled(){return c(ke)},width:"auto",get model(){return c(X)},get modelCount(){return c(be)},itemSize:25,vl_slot:(D,j)=>{let d=()=>j==null?void 0:j().item;var h=B(),k=L(h);q(k,d,Q=>{var Z=Y(()=>Ne(d().class,{"drag-placeholder-wrapper":d().data===E,"dragging-node":d()===w}));vt(Q,{get class(){return c(Z)},get style(){return d().style},get nodeInfo(){return d()},get rtl(){return o()},get btt(){return a()},get indent(){return r()},get treeLine(){return v()},get treeLineOffset(){return O()},get processor(){return t()},onNodeOpened:M=>{var S;return(S=e.onNodeOpened)==null?void 0:S.call(e,M)},onNodeClosed:M=>{var S;return(S=e.onNodeClosed)==null?void 0:S.call(e,M)},onNodeSelected:M=>{var S;return(S=e.onNodeSelected)==null?void 0:S.call(e,M)},onNodeChecked:M=>{var S;return(S=e.onNodeChecked)==null?void 0:S.call(e,M)},tn_slot:(M,S=nt)=>{var Ke=B(),Je=L(Ke);q(Je,()=>S().data===E,we=>{var se=bt(),Re=ee(se);q(Re,()=>e.placeholder,We=>{var Le=B(),Ye=L(Le);ne(Ye,()=>e.placeholder),b(We,Le)}),te(se),b(we,se)},we=>{var se=B(),Re=L(se);ne(Re,()=>e.tree_slot,S),b(we,se)}),b(M,Ke)},$$slots:{tn_slot:!0}})}),b(D,h)},$$slots:{vl_slot:!0}}),D=>A=D,()=>A),Pe()}var Ot=J('<div class="item svelte-1s0qzrn"><!></div>'),At=J('<section class="svelte-1s0qzrn"><!></section>'),Pt=J("<b> </b> <!>",1);function qe(i,e){Ae(e,!0);let t=g(e,"tree",15),n=g(e,"node",7);const s=300;function r(I){n().children=I.detail.items}function l(I){n().children=I.detail.items,t({...t()})}var o=Pt(),a=L(o),v=ee(a);te(a);var O=ce(a,2);q(O,()=>{var I;return(I=n())==null?void 0:I.children},I=>{var u=At(),A=ee(u);q(A,()=>n().children,K=>{var y=B(),w=L(y);Oe(w,25,()=>n().children,z=>z.id,(z,E)=>{var N=Ot(),_=ee(N);qe(_,{get tree(){return t()},set tree(P){t(P)},get node(){return t()[c(E).id]}}),te(N),st(N,()=>lt,()=>({duration:s})),b(z,N)}),b(K,y)}),te(u),Ve("consider",u,r),Ve("finalize",u,l),rt(u,(K,y)=>ot(K,y),()=>({items:n().children||[],flipDurationMs:s,centreDraggedOnCursor:!0})),b(I,u)}),le(()=>{var I,u;ae(a,"style",`color:${((I=n())==null?void 0:I.color)??""}`),it(v,(u=n())==null?void 0:u.name)}),b(i,o),Pe()}var kt=J("<h3>Try dragging node2 into node3 and then node4 into node2</h3> <!>",1);function Nt(i){let e=R(m({node1:{name:"node 1",children:[{id:"node2"},{id:"node3"},{id:"node4"}],id:"node1"},node2:{name:"node 2",children:[{id:"node5"},{id:"node6"},{id:"node7"},{id:"node8"}],id:"node2"},node3:{name:"node 3",children:[{id:"node9"},{id:"node10"},{id:"node11"},{id:"node12"}],id:"node3"},node4:{name:"node 4",children:[{id:"node13"},{id:"node14"},{id:"node15"},{id:"node16"}],id:"node4",color:"salmon"}}));for(let s=5;s<17;(s+=1)-1)c(e)[`node${s}`]={id:`node${s}`,name:`item ${s}`};c(e).node10.color="steelblue",c(e).node11.color="steelblue",c(e).node14.color="orange",c(e).node15.color="orange",c(e).node6.color="forestgreen";var t=kt(),n=ce(L(t),2);qe(n,{get node(){return c(e).node1},get tree(){return c(e)},set tree(s){C(e,m(s))}}),b(i,t)}export{Nt as A,Et as T};
