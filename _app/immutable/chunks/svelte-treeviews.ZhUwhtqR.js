var Je=Object.defineProperty;var Ae=i=>{throw TypeError(i)};var We=(i,e,t)=>e in i?Je(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var C=(i,e,t)=>We(i,typeof e!="symbol"?e+"":e,t),Ye=(i,e,t)=>e.has(i)||Ae("Cannot "+t);var oe=(i,e,t)=>(Ye(i,e,"read from private field"),t?t.call(i):e.get(i)),be=(i,e,t)=>e.has(i)?Ae("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import{d as we,p as te,a as x,s as J,b as D,u as he,o as Le,c as Xe,g,e as F,f as Ge,i as K,t as j,h as y,j as ne,k as P,l as V,m as Q,n as R,q as fe,r as A,v as me,w as E,x as Se,y as p,z as se,A as Te,B as q,C as pe,D as ze,E as $e,F as Fe,G as Ke,H as G,I as et,J as He,K as Ue,L as tt,M as Ee,N as De,O as nt}from"./external.BPtDOYew.js";const it="modulepreload",rt=function(i){return"/svelte-treeviews/"+i},Ne={},lt=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.all(t.map(s=>{if(s=rt(s),s in Ne)return;Ne[s]=!0;const d=s.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${h}`))return;const a=document.createElement("link");if(a.rel=d?"stylesheet":it,d||(a.as="script"),a.crossOrigin="",a.href=s,o&&a.setAttribute("nonce",o),document.head.appendChild(a),d)return new Promise((c,f)=>{a.addEventListener("load",c),a.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})}))}return r.then(()=>e()).catch(l=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l})};we(["click"]);class ot{constructor(e,t,n,r){C(this,"model");C(this,"modelCount");C(this,"itemSize");C(this,"estimatedItemSize");C(this,"itemSizeAndPositionData");C(this,"lastMeasuredIndex");C(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=r,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),r=e;e+=n,this.itemSizeAndPositionData[t]={offset:r,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const l=this.getSize(r);if(l===void 0||isNaN(l))throw Error(`Invalid size returned for index ${r} of value ${l}`);this.itemSizeAndPositionData[r]={offset:n,size:l},n+=l}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=ce.START,t,n,r){if(t<=0)return 0;const l=this.getSizeAndPositionForIndex(r),o=l.offset,s=o-t+l.size;let d;switch(e){case ce.END:d=s;break;case ce.CENTER:d=o-(t-l.size)/2;break;case ce.START:d=o;break;default:d=Math.max(s,Math.min(o,n))}const h=this.getTotalSize();return Math.max(0,Math.min(h-t,d))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const l=t+e;let o=this.findNearestItem(t);if(o===void 0)throw Error(`Invalid offset ${t} specified`);const s=this.getSizeAndPositionForIndex(o);t=s.offset+s.size;let d=o;for(;t<l&&d<this.modelCount-1;)d++,t+=this.getSizeAndPositionForIndex(d).size;return n&&(o=Math.max(0,o-n),d=Math.min(d+n,this.modelCount-1)),{start:o,end:d}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let r=0,l=0;for(;e<=t;){if(r=e+Math.floor((t-e)/2),l=this.getSizeAndPositionForIndex(r).offset,l===n)return r;l<n?e=r+1:l>n&&(t=r-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}const st=(()=>{let i=!1;try{const e=Object.defineProperty({},"passive",{get(){return i={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return i})();var dt=P('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');function at(i,e){te(e,!0);const t=x(e,"width",3,"100%"),n=x(e,"model",19,()=>[]),r=x(e,"windowOverPadding",3,3),l=x(e,"scrollDirection",19,()=>B.VERTICAL),o=x(e,"scrollToAlignment",19,()=>ce.AUTO),s=x(e,"scrollToBehaviour",19,()=>Ve.INSTANT),d=x(e,"class",3,"");x(e,"style",3,"");const h={[B.VERTICAL]:"top",[B.HORIZONTAL]:"left"},a={[B.VERTICAL]:"scrollTop",[B.HORIZONTAL]:"scrollLeft"},c=new ot(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let f=!1,u,I=J(D([])),m=J(D({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&W(e.scrollToIndex)||0,scrollChangeReason:ae.REQUESTED})),_={},S={scrollToIndex:e.scrollToIndex,scrollToAlignment:o(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},k={},z=J(""),T=J("");he(()=>{e.scrollToIndex,o(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,M()}),he(()=>{g(m),O()}),he(()=>{e.height,t(),f&&H(0)}),(()=>{if(l()===B.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(l()===B.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());w()})(),Le(()=>{u.addEventListener("scroll",de,st),e.scrollOffset!==void 0?L(e.scrollOffset):e.scrollToIndex!==void 0&&L(W(e.scrollToIndex)),f=!0}),Xe(()=>{f&&u.removeEventListener("scroll",de)});function M(){if(!f)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const v=S.scrollToIndex!==e.scrollToIndex||S.scrollToAlignment!==o(),b=S.modelCount!==e.modelCount||S.itemSize!==e.itemSize||S.estimatedItemSize!==e.estimatedItemSize;b&&(c.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),H()),S.scrollOffset!==e.scrollOffset?F(m,D({offset:e.scrollOffset||0,scrollChangeReason:ae.REQUESTED})):typeof e.scrollToIndex=="number"&&(v||b)&&F(m,D({offset:W(e.scrollToIndex,o(),e.modelCount),scrollChangeReason:ae.REQUESTED})),S={scrollToIndex:e.scrollToIndex,scrollToAlignment:o(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function O(){if(!f)return;const{offset:v,scrollChangeReason:b}=g(m);(_.offset!==v||_.scrollChangeReason!==b)&&w(),_.offset!==v&&b===ae.REQUESTED&&L(v),_=g(m)}function w(){if(n().length===0||e.isDisabled)return;const{offset:v}=g(m);let{start:b,end:N}=c.getVisibleRange(l()===B.VERTICAL?e.height:t(),v,r()),Z=[];const Y=c.getTotalSize(),re=typeof e.height=="number"?"px":"",le=typeof t()=="number"?"px":"";if(l()===B.VERTICAL?(F(z,`height:${e.height}${re};width:${t()}${le};`),F(T,`flex-direction:column;height:${Y}px;`)):(F(z,`height:${e.height}${re};width:${t()}${le};`),F(T,`min-height:100%;width:${Y}px;`)),n()&&b!==void 0&&N!==void 0){for(let X=b;X<=N;(X+=1)-1)Z.push({item:n()[X],index:X,style:Pe(X)});if(e.onVisibleRangeUpdate){const X=c.getVisibleRange(l()===B.VERTICAL?e.height:t(),v,0);e.onVisibleRangeUpdate({type:"range.update",start:X.start,end:X.end})}}F(I,D(Z))}function L(v){"scroll"in u?u.scroll({[h[l()]]:v,behavior:s()}):u[a[l()]]=v}function H(v=0){k={},c.resetItem(v),w()}function W(v,b=o(),N=e.modelCount){return v<0?v=0:v>=N&&(v=N-1),c.getUpdatedOffsetForIndex(b,l()===B.VERTICAL?e.height:t(),g(m).offset||0,v)}const de=v=>{const b=u[a[l()]];b<0||g(m).offset===b||v.target!==u||(F(m,D({offset:b,scrollChangeReason:ae.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:b,event:v}))};function Pe(v){if(k[v])return k[v];const{size:b,offset:N}=c.getSizeAndPositionForIndex(v),Z=l()===B.VERTICAL?`left:0;width:100%;height:${b}px;position:absolute;top:${N}px;`:`top:0;width:${b}px;position:absolute;height:100%;left:${N}px;`;return k[v]=Z}var U=dt();Ge(U,v=>u=v,()=>u);var ue=A(U);K(ue,()=>e.header,v=>{var b=Q(),N=R(b);se(N,()=>e.header),y(v,b)});var ie=V(ue,2),Ce=A(ie);K(Ce,()=>e.isDisabled,v=>{var b=Q(),N=R(b);fe(N,17,n,me,(Z,Y,re)=>{var le=Q(),X=R(le);se(X,()=>e.vl_slot,()=>({item:g(Y),style:"",index:re})),y(Z,le)}),y(v,b)},v=>{var b=Q(),N=R(b);fe(N,17,()=>g(I),me,(Z,Y)=>{var re=Q(),le=R(re);se(le,()=>e.vl_slot,()=>({item:g(Y).item,style:g(Y).style,index:g(Y).index})),y(Z,re)}),y(v,b)}),E(ie);var ge=V(ie,2);return K(ge,()=>e.footer,v=>{var b=Q(),N=R(b);se(N,()=>e.footer),y(v,b)}),E(U),j(()=>{Se(U,`virtual-list-wrapper $${d()??""} svelte-f32i87`),p(U,"style",g(z)),p(ie,"style",g(T))}),y(i,U),ne({recomputeSizes:H})}var Ve=(i=>(i.AUTO="auto",i.SMOOTH="smooth",i.INSTANT="instant",i))(Ve||{}),ce=(i=>(i.AUTO="auto",i.START="start",i.CENTER="center",i.END="end",i))(ce||{}),B=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(B||{}),ae=(i=>(i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED",i))(ae||{}),ct=P('<div class="tree-line tree-vline svelte-gfld7i"></div>'),ht=P('<div class="tree-line tree-hline svelte-gfld7i"></div>'),ft=P("<!> <!>",1),ut=P('<div><!> <div class="tree-node-inner"><!></div></div>');function gt(i,e){te(e,!0);let t=x(e,"rtl",3,!1),n=x(e,"btt",3,!1),r=x(e,"indent",3,20),l=x(e,"treeLine",3,!0),o=x(e,"treeLineOffset",3,10),s=x(e,"class",3,""),d=x(e,"style",3,""),h=q(()=>`${t()?"paddingRight":"paddingLeft"}:${r()*(e.nodeInfo.level-1)}px`),a=q(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*r()+o()}px`);he(()=>{var z,T;const k=e.nodeInfo.expended;console.log("toggleOpen"),!c&&(k?(z=e.onNodeOpened)==null||z.call(e,e.nodeInfo):(T=e.onNodeclosed)==null||T.call(e,e.nodeInfo),f())}),he(()=>{var k,z;e.nodeInfo.checked,!c&&(k=e.processor)!=null&&k.afterOneCheckChanged(e.nodeInfo)&&((z=e.onNodeChecked)==null||z.call(e,e.nodeInfo))});let c=!1;const f=()=>{c=!0,setTimeout(()=>{c=!1},100)},u=q(()=>{const k=[],z=w=>{var L;if(w.parent){let H=(L=w.parent)==null?void 0:L.children.indexOf(w);do{H+=1;const W=w.parent.children[H];if(W){if(!W.hidden)return!0}else break}while(!0)}return!1},T=t()?"right":"left",M=n()?"top":"bottom";let O=e.nodeInfo;for(;O;){const w=(O.level-2)*r()+o(),L=z(O),H=()=>{k.push({style:`${T}:${w}px;${M}:${L?"0":"50%"}`})};O===e.nodeInfo?O.level>1&&H():L&&H(),O=O.parent}return k});var I=ut();j(()=>Se(I,`${Te("tree-node",s(),l()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var m=A(I);K(m,l,k=>{var z=ft(),T=R(z);fe(T,17,()=>g(u),me,(O,w)=>{var L=ct();j(()=>p(L,"style",g(w).style)),y(O,L)});var M=V(T,2);K(M,()=>e.nodeInfo.level>1,O=>{var w=ht();j(()=>p(w,"style",g(a))),y(O,w)}),y(k,z)});var _=V(m,2),S=A(_);se(S,()=>e.tn_slot,()=>({data:e.nodeInfo.nodeData,info:e.nodeInfo})),E(_),E(I),j(()=>p(I,"style",`${d()} ${g(h)}`)),y(i,I),ne()}function ke(i){return Object.prototype.toString.call(i)==="[object Array]"}function vt(i){return i[i.length-1]}function mt(i,e){let t,n=0;for(;(t=i.indexOf(e))>-1;)i.splice(t,1),n++;return n}function It(i,e,t){i.hasOwnProperty(e)||(i[e]=t)}function _t(i,e){return Object.keys(e).forEach(t=>{It(i,t,e[t])}),i}function xt(i){const e={};return Object.keys(i).forEach(t=>{i[t]!==void 0&&(e[t]=i[t])}),e}function $(i,e,t={}){t=_t({...t},{childrenKey:"children"});const n=t.childrenKey,r=ke(i)?i:[i];class l{}const o=(s,d,h)=>{t.reverse&&(s=s.slice(),s.reverse());const a=s.length;for(let c=0;c<a;c++){const f=s[c],u=t.reverse?a-c-1:c,I=h?[...h,u]:[];t.childFirst&&f[n]!=null&&o(f[n],f,I);const m=e(f,u,d,I);if(m===!1)throw new l;if(m==="skip children")continue;if(m==="skip siblings")break;t.childFirst||f[n]!=null&&o(f[n],f,I)}};try{o(r,null,ke(i)?[]:null)}catch(s){if(!(s instanceof l))throw s}}function St(i,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,r=t.nodeHandler,l=new Oe;return l.childrenKey=n,$(i,(o,s,d,h)=>{let a=Object.assign({},o);a[n]&&(a[n]=[]),r&&(a=r(a,{oldNode:o,index:s,parent:d,path:h})),l.set(h,a)},{childrenKey:n}),l.data}class Oe{constructor(e=[]){C(this,"data");C(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return ke(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:r}=this;if(t.reverse){const l=[...this.iteratePath(e,{...t,reverse:!1})];l.reverse();for(const{path:o,node:s}of l)yield{path:o,node:s}}else{let l=[],o=r;for(const s of e){const d=[...l,s],h=o[s];yield{path:d,node:h},l=d,o=h[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return vt(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:r}=this;const{parent:l,index:o}=this.getParentAndIndex(e);let s;e.length===1?(r||(this.data?this.data[n]=[]:this.data=[]),s=r):(l[n]||(l[n]=[]),s=l[n]),s[o]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:r,index:l}=this.getParentAndIndex(e),o=e.length===1?n:r[t],s=o[l];return o.splice(l,1),s}walk(e,t){const{childrenKey:n,data:r}=this;return $(r,e,n)}clone(e={}){return St(this.data),xt({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}class ve{constructor(e){C(this,"nodeData");C(this,"expended");C(this,"parent");C(this,"children");C(this,"level");C(this,"hidden");C(this,"checked");C(this,"draggable");C(this,"droppable");C(this,"style");C(this,"class");C(this,"_ignoreCheckedOnce");this.nodeData=(e==null?void 0:e.nodeData)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=(e==null?void 0:e.style)||null,this.class=(e==null?void 0:e.class)||null,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}class Be{constructor(e){C(this,"childrenKey",ee);C(this,"defaultOpen",!1);C(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||ee,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}afterSetInfoNode(e,t,n){}afterRemoveInfoNode(e){}infoHandler(e){return e}}class bt extends Be{constructor(t){super(t);C(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=D(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=D(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=D(t);return this.filter(super.InfoNodesFlatHandler,n)}}const ee="children";var Ie,_e,xe;class yt{constructor(e){C(this,"nodeData");be(this,Ie,J(D([])));be(this,_e,J(D([])));be(this,xe,J(null));C(this,"options");C(this,"initialized",!1);this.options=e||new Be}get nodeInfos(){return g(oe(this,Ie))}set nodeInfos(e){F(oe(this,Ie),D(e))}get nodeInfosToRender(){return g(oe(this,_e))}set nodeInfosToRender(e){F(oe(this,_e),D(e))}get _infosMap(){return g(oe(this,xe))}set _infosMap(e){F(oe(this,xe),D(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new Oe([]);this._infosMap=new Map,$(this.nodeData,(r,l,o,s)=>{const d=this.options.infoHandler(new ve({nodeData:r,expended:!!this.options.defaultOpen,parent:t.getParent(s),children:[],level:s.length}));this._infosMap.set(r,d),t.set(s,d)},{childrenKey:e}),console.log("td",t),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren);const n=[];t.walk(r=>{n.push(r)}),console.log("rootChildren",t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new Re("NodeInfo not found");return t}has(e){if(e instanceof ve)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof Re)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=r=>{const l=r.parent;if(l){let o=!1,s=!1;for(const h of l.children)if(h.checked||h.checked===0)o=!0;else if(s=!0,o&&s)break;const d=s?o?0:!1:!0;l.checked!==d&&(this._ignoreCheckedOnce(l),l.checked=d),n(l)}};return n(e),$(e.children,r=>{r.checked!==t&&(this._ignoreCheckedOnce(r),r.checked=t)},{childrenKey:ee}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof ve?e:this.getNodeInfo(e),n=r=>!r||!r.hidden&&r.expended&&n(r.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){$(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:ee})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof ve?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const r=e?e.children:this.nodeInfos;for(let l=0;l<t;(l+=1)-1)n+=this._count(r[l]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const r=t?t.children:this.nodeInfos;n==null&&(n=r.length);const l=this.options.infoHandler(new ve({expended:!!this.options.defaultOpen,nodeData:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(l,t||null,n);const o=e[this.childrenKey];if(o){const s=o.slice();for(const d of s)this.add(d,l)}}remove(e){const t=this.getSiblings(e);if(t.includes(e)){mt(t,e);const n=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),n.length);for(const r of n)this._infosMap.delete(r.nodeData);return this.options.afterRemoveInfoNode(e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const l=this._calcFlatIndex(t,n),o=this._flat(e);this.nodeInfosToRender.splice(l,0,...o);for(const s of o)this._infosMap.has(s.nodeData)||this._infosMap.set(s.nodeData,s);$(e,(s,d,h)=>{h&&(s.level=h.level+1)},{childrenKey:ee}),this.options.afterSetInfoNode(e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let r;for(const l of this.iterateParent(t))if(l.level===e.level){r=l;break}if(e===r)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return $(e,n=>{t.push(n)},{childrenKey:ee}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,r=new Oe([]);return r.childrenKey=n,$(t||this.nodeInfos,(l,o,s,d)=>{let h={...l.nodeData,[n]:[]};e&&(h=e(h)),r.set(d,h)},{childrenKey:ee}),r.data}}Ie=new WeakMap,_e=new WeakMap,xe=new WeakMap;class Re extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}function zt(i,e){const t=new bt(e),n=new yt(t);return t.noInitialization||n.init(),n}var Ct=P('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function Jt(i,e){te(e,!0);let t=x(e,"processor",23,()=>zt([],{noInitialization:!0}));x(e,"updateBehavior",3,"modify"),x(e,"childrenKey",3,ee),x(e,"textKey",3,"text");let n=x(e,"indent",3,20),r=x(e,"virtualization",3,!1);x(e,"virtualizationPrerenderCount",3,20),x(e,"defaultOpen",3,!0);let l=x(e,"rtl",3,!1),o=x(e,"btt",3,!1);x(e,"nodeKey",3,"index");let s=x(e,"treeLine",3,!1),d=x(e,"treeLineOffset",3,8);x(e,"class",3,"");let h=x(e,"style",3,""),a=J(D([])),c=null,f=!1,u={};he(()=>{e.model,console.log("model change detected"),console.log("Initializing model"),t().nodeData=e.model,t().init(),F(a,D(t().nodeInfosToRender))});function I(){let T=g(a)||[];return o()&&(T=T.slice().reverse()),T.filter(M=>m(M))}function m(T){return t().isVisible(T)}var _=q(()=>Te("he-tree",l()&&"he-tree--rtl rtl",f)),S=q(()=>!r()),k=q(I),z=q(()=>{var T;return((T=t().nodeInfos)==null?void 0:T.length)||0});at(i,{get class(){return g(_)},get style(){return h()},height:500,get isDisabled(){return g(S)},width:"auto",get model(){return g(k)},get modelCount(){return g(z)},itemSize:25,vl_slot:(M,O)=>{let w=()=>O==null?void 0:O().item;var L=Q(),H=R(L);K(H,w,W=>{var de=q(()=>Te(w().class,{"drag-placeholder-wrapper":w().nodeData===u,"dragging-node":w()===c}));gt(W,{get class(){return g(de)},get style(){return w().style},get nodeInfo(){return w()},get rtl(){return l()},get btt(){return o()},get indent(){return n()},get treeLine(){return s()},get treeLineOffset(){return d()},get processor(){return t()},onNodeOpened:U=>e.onNodeOpened&&e.onNodeOpened(U),onNodeclosed:U=>e.onNodeClosed&&e.onNodeClosed(U),onNodeChecked:U=>e.onNodeChecked&&e.onNodeChecked(U),tn_slot:(U,ue=pe)=>{var ie=Q(),Ce=R(ie);K(Ce,()=>ue().data===u,ge=>{var v=Ct(),b=A(v);K(b,()=>e.placeholder,N=>{var Z=Q(),Y=R(Z);se(Y,()=>e.placeholder),y(N,Z)}),E(v),y(ge,v)},ge=>{var v=Q(),b=R(v);se(b,()=>e.tree_slot,ue),y(ge,v)}),y(U,ie)}})}),y(M,L)}}),ne()}var Tt=P('<div class="item svelte-1s0qzrn"><!></div>'),kt=P('<section class="svelte-1s0qzrn"><!></section>'),Ot=P("<b> </b> <!>",1);function je(i,e){te(e,!0);let t=x(e,"tree",15),n=x(e,"node",7);const r=300;function l(c){n().children=c.detail.items}function o(c){n().children=c.detail.items,t({...t()})}var s=Ot(),d=R(s),h=A(d);E(d);var a=V(d,2);K(a,()=>{var c;return(c=n())==null?void 0:c.children},c=>{var f=kt(),u=A(f);K(u,()=>n().children,I=>{var m=Q(),_=R(m);fe(_,25,()=>n().children,S=>S.id,(S,k)=>{var z=Tt(),T=A(z);je(T,{get tree(){return t()},set tree(M){t(M)},get node(){return t()[g(k).id]}}),E(z),$e(z,()=>et,()=>({duration:r})),y(S,z)}),y(I,m)}),E(f),Fe(f,(I,m)=>Ke(I,m),()=>({items:n().children||[],flipDurationMs:r,centreDraggedOnCursor:!0})),G("consider",f,l),G("finalize",f,o),y(c,f)}),j(()=>{var c,f;p(d,"style",`color:${((c=n())==null?void 0:c.color)??""}`),ze(h,(f=n())==null?void 0:f.name)}),y(i,s),ne()}var wt=P("<h3>Try dragging node2 into node3 and then node4 into node2</h3> <!>",1);function Wt(i){let e=J(D({node1:{name:"node 1",children:[{id:"node2"},{id:"node3"},{id:"node4"}],id:"node1"},node2:{name:"node 2",children:[{id:"node5"},{id:"node6"},{id:"node7"},{id:"node8"}],id:"node2"},node3:{name:"node 3",children:[{id:"node9"},{id:"node10"},{id:"node11"},{id:"node12"}],id:"node3"},node4:{name:"node 4",children:[{id:"node13"},{id:"node14"},{id:"node15"},{id:"node16"}],id:"node4",color:"salmon"}}));for(let r=5;r<17;(r+=1)-1)g(e)[`node${r}`]={id:`node${r}`,name:`item ${r}`};g(e).node10.color="steelblue",g(e).node11.color="steelblue",g(e).node14.color="orange",g(e).node15.color="orange",g(e).node6.color="forestgreen";var t=wt(),n=V(R(t),2);je(n,{get node(){return g(e).node1},get tree(){return g(e)},set tree(r){F(e,D(r))}}),y(i,t)}var Pt=P("<div></div>");function Me(i,e){te(e,!0);const{getDragged:t}=He("dragging");let n=J(!1);function r(a){return 1}function l(a){!a.target||!a.target.id||(r(a.target.id),F(n,!0))}function o(a){!a.target||!a.target.id||(r(a.target.id)>0&&e.ondrop({oldPosition:t(),newPosition:a.target.id.split("-")}),s())}function s(){F(n,!1)}function d(){return`dropzone-${e.prefix}`}var h=Pt();j(()=>p(h,"id",d())),j(()=>Se(h,`${`dropzone ${g(n)?"active":"idle"}`??""} svelte-1n7j4p5`)),G("dragleave",h,()=>s()),G("dragenter",h,a=>l(a)),G("drop",h,a=>o(a)),G("dragover",h,()=>!1),y(i,h),ne()}var At=P("<span> </span>");function Qe(i,e){var t=At(),n=A(t);E(t),j(()=>{Se(t,`${`clickable ${e.isLeafNode?"isLeafNode":""}`??""} svelte-13dhc3a`),ze(n,e.label)}),y(i,t)}const Et=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));function Dt(i,e){e(!e())}function Nt(i,e,t){var n;(n=e.onselected)==null||n.call(e,`${t()}`.split("-"))}var Rt=P("<i></i>"),Mt=P('<li class="svelte-1bsomvo"><!></li>'),Lt=P('<ul class="svelte-1bsomvo"><!> <li class="svelte-1bsomvo"><!></li></ul>'),Ft=P('<!>  <div draggable="true"><!> <div class="node-wrapper svelte-1bsomvo"><!></div></div> <!>',1);function qe(i,e){te(e,!0),He("dragging");let t=x(e,"expanded",7,!1),n=x(e,"prefix",3,""),r=q(()=>!Array.isArray(e.children)),l=q(()=>n()===null);function o(){}function s(_){var S;!_.target||!_.target.id||(S=e.ondragstart)==null||S.call(e,_.target.id.split("-"))}function d(_){return n()!==null?`${n()}-${_}`:_}var h=Ft(),a=R(h);K(a,()=>!g(l),_=>{Me(_,{get ondrop(){return e.ondrop},get prefix(){return n()}})});var c=V(a,2),f=A(c);K(f,()=>!g(r),_=>{var S=Rt();S.__click=[Dt,t],j(()=>Se(S,`${`clickable toggle-icon ${t()?e.internalOptions.collapseClass:e.internalOptions.expandClass}`??""} svelte-1bsomvo`)),y(_,S)});var u=V(f,2);u.__click=[Nt,e,n];var I=A(u);Qe(I,{get label(){return e.label},get isLeafNode(){return g(r)}}),E(u),E(c);var m=V(c,2);K(m,()=>t()&&!g(r),_=>{var S=Lt(),k=A(S);fe(k,17,()=>e.children,me,(O,w,L)=>{var H=Mt(),W=A(H),de=q(()=>d(L));qe(W,Ue(()=>g(w),{get internalOptions(){return e.internalOptions},get expanded(){return t()},get prefix(){return g(de)},get onselected(){return e.onselected},ondragenter:!0,ondragleave:!0,get ondragstart(){return e.ondragstart},ondragend:!0,get ondrop(){return e.ondrop}})),E(H),y(O,H)});var z=V(k,2),T=A(z),M=q(()=>{var O;return d((O=e.children)==null?void 0:O.length)});Me(T,{get ondrop(){return e.ondrop},get prefix(){return g(M)}}),E(z),E(S),y(_,S)}),j(()=>p(c,"id",n())),G("dragstart",c,_=>s(_)),G("dragend",c,o),y(i,h),ne()}we(["click"]);var Kt=P('<div class="tree"><!></div>');function Yt(i,e){te(e,!0);let t={labelFormatter:()=>lt(()=>Promise.resolve().then(()=>Et),void 0),collapseClass:"chevron bottom",expandClass:"chevron right"};Le(async()=>{t=Object.assign(t,e.options)});let n;tt("dragging",{getDragged:()=>n});function r(f){var u;(u=e.onselected)==null||u.call(e,o(f.slice(),e.treeItems))}function l(f){n=f.detail}function o(f,u){if(f.length===0)return u;const I=f.shift(),m=u.children[I];return m.hasOwnProperty("children")?o(f,m):m}function s(f,u){let I=[];for(let m=0;m<f.length;(m+=1)-1)f[m]===u&&I.push(m);return I}function d(f,u,I,m){if(f!==u)return f.children.indexOf(m);const _=s(f.children,m);if(_.length!==2){console.error("found too few/too many indexes",_);return}return _.find(S=>`${S}`!=`${I.slice().pop()}`)}function h(f){var z;const u=f.detail.oldPosition.slice(),I=f.detail.newPosition.slice(1),m=o(u.slice(0,u.length-1),e.treeItems),_=o(I.slice(0,I.length-1),e.treeItems),S=o(u.slice(),e.treeItems);_.children.splice(I.slice().pop(),0,S);const k=d(m,_,I.slice(),S);m.children.splice(k,1),n=null,(z=e.onmodelChanged)==null||z.call(e,e.treeItems)}var a=Kt(),c=A(a);K(c,()=>e.treeItems,f=>{qe(f,Ue(()=>e.treeItems,{internalOptions:t,expanded:!0,onselected:u=>r(u.detail),ondragstart:u=>l(u),ondrop:h}))}),E(a),y(i,a),ne()}const Ht=(i,e)=>{e(e().expanded=!e().expanded,!0)},ye=(i,e,t)=>{e(e().checked=!e().checked,!0),t.ontoggle&&t.ontoggle({node:e()})};var Ut=P('<div class="item"><!></div>'),Vt=P('<input type="checkbox"> <span class="arrow svelte-9p8428"></span> <span> </span> <!>',1),Bt=P('<input type="checkbox"> <span> </span>',1),jt=P('<ul class="svelte-9p8428"><li><!></li></ul>');function Ze(i,e){te(e,!0);let t=x(e,"node",15);const n=300;function r(h){t(t().children=h.detail.items,!0)}function l(h){t(t().children=h.detail.items,!0),t({...t()})}var o=jt(),s=A(o),d=A(s);K(d,()=>t().children,h=>{var a=Vt(),c=R(a);Ee(c),c.__click=[ye,t,e];var f=V(c,2);f.__click=[Ht,t];var u=V(f,2);u.__click=[ye,t,e];var I=A(u);E(u);var m=V(u,2);K(m,()=>t().expanded,_=>{var S=Q(),k=R(S);fe(k,17,()=>t().children,me,(z,T)=>{var M=Ut(),O=A(M);Ze(O,{get node(){return g(T)},get ontoggle(){return e.ontoggle}}),E(M),y(z,M)}),y(_,S)}),j(()=>{p(c,"data-label",t().label),De(c,t().checked),c.indeterminate=t().indeterminate,nt(f,"arrowDown",t().expanded),ze(I,t().label)}),y(h,a)},h=>{var a=Bt(),c=R(a);Ee(c),c.__click=[ye,t,e];var f=V(c,2);f.__click=[ye,t,e];var u=A(f);E(f),j(()=>{p(c,"data-label",t().label),De(c,t().checked),c.indeterminate=t().indeterminate,ze(u,t().label)}),y(h,a)}),E(s),E(o),Fe(s,(h,a)=>Ke(h,a),()=>({items:t().children||[],flipDurationMs:n,centreDraggedOnCursor:!0})),G("consider",s,r),G("finalize",s,l),y(i,o),ne()}we(["click"]);var Qt=P("<div><!></div>");function Xt(i){let e=J(D({label:"root",expanded:!0,children:[{label:"node A",children:[{label:"node Aa"},{label:"node Ab",checked:!0}]},{label:"node B"},{label:"node C"},{label:"node D"}]}));const t={};function n(d=g(e)){if(d.children)for(const h of d.children)t[h.label]=d,n(h)}n();function r(d,h=!0){if(d.children){for(const a of d.children)h&&(a.checked=!!d.checked),r(a,h);d.indeterminate=d.children.some(a=>a.indeterminate)||d.children.some(a=>!!a.checked)&&d.children.some(a=>!a.checked)}}function l(d,h=!0){const a=d.node;let c=t[a.label];for(r(a,h);c;){if(c.children.every(u=>!!u.checked))c.indeterminate=!1,c.checked=!0;else{const u=c.children.some(I=>!!I.checked||I.indeterminate);c.indeterminate=!!u,c.checked=!1}c=t[c.label]}}l({node:g(e)},!1);var o=Qt(),s=A(o);Ze(s,{get node(){return g(e)},set node(d){F(e,D(d))},ontoggle:l}),E(o),y(i,o)}export{Wt as A,Jt as T,lt as _,Xt as a,Yt as b};
