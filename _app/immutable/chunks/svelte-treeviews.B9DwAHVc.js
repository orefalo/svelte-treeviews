var qe=Object.defineProperty;var Ae=i=>{throw TypeError(i)};var Je=(i,e,t)=>e in i?qe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var z=(i,e,t)=>Je(i,typeof e!="symbol"?e+"":e,t),We=(i,e,t)=>e.has(i)||Ae("Cannot "+t);var me=(i,e,t)=>(We(i,e,"read from private field"),t?t.call(i):e.get(i)),Te=(i,e,t)=>e.has(i)?Ae("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import{d as we,p as te,a as x,s as $,b as M,u as he,o as Ke,c as Ye,g as m,e as V,f as Xe,i as K,t as B,h as b,j as ne,k as P,l as L,m as Q,n as N,q as fe,r as R,v as Ie,w,x as Se,y as X,z as oe,A as ke,B as Z,C as Ge,D as pe,E as ze,F as $e,G as et,H as Ee,I as ee,J as tt,K as nt,L as ae,M as it,N as Fe,O as Ve,P as rt,Q as Re,R as Ne,S as st}from"./external.CooFuegG.js";const ot="modulepreload",lt=function(i){return"/svelte-treeviews/"+i},De={},at=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.all(t.map(a=>{if(a=lt(a),a in De)return;De[a]=!0;const o=a.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":ot,o||(d.as="script",d.crossOrigin=""),d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),o)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})};we(["click"]);class dt{constructor(e,t,n,r){z(this,"model");z(this,"modelCount");z(this,"itemSize");z(this,"estimatedItemSize");z(this,"itemSizeAndPositionData");z(this,"lastMeasuredIndex");z(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=r,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),r=e;e+=n,this.itemSizeAndPositionData[t]={offset:r,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let r=this.lastMeasuredIndex+1;r<=e;r++){const s=this.getSize(r);if(s===void 0||isNaN(s))throw Error(`Invalid size returned for index ${r} of value ${s}`);this.itemSizeAndPositionData[r]={offset:n,size:s},n+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=ce.START,t,n,r){if(t<=0)return 0;const s=this.getSizeAndPositionForIndex(r),l=s.offset,a=l-t+s.size;let o;switch(e){case ce.END:o=a;break;case ce.CENTER:o=l-(t-s.size)/2;break;case ce.START:o=l;break;default:o=Math.max(a,Math.min(l,n))}const c=this.getTotalSize();return Math.max(0,Math.min(c-t,o))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const s=t+e;let l=this.findNearestItem(t);if(l===void 0)throw Error(`Invalid offset ${t} specified`);const a=this.getSizeAndPositionForIndex(l);t=a.offset+a.size;let o=l;for(;t<s&&o<this.modelCount-1;)o++,t+=this.getSizeAndPositionForIndex(o).size;return n&&(l=Math.max(0,l-n),o=Math.min(o+n,this.modelCount-1)),{start:l,end:o}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let r=0,s=0;for(;e<=t;){if(r=e+Math.floor((t-e)/2),s=this.getSizeAndPositionForIndex(r).offset,s===n)return r;s<n?e=r+1:s>n&&(t=r-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}var ct=P('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');const ht=(()=>{let i=!1;try{const e=Object.defineProperty({},"passive",{get(){return i={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return i})();function ft(i,e){te(e,!0);const t=x(e,"width",3,"100%"),n=x(e,"model",19,()=>[]),r=x(e,"windowOverPadding",3,3),s=x(e,"scrollDirection",19,()=>U.VERTICAL),l=x(e,"scrollToAlignment",19,()=>ce.AUTO),a=x(e,"scrollToBehaviour",19,()=>He.INSTANT),o=x(e,"class",3,"");x(e,"style",3,"");const c={[U.VERTICAL]:"top",[U.HORIZONTAL]:"left"},d={[U.VERTICAL]:"scrollTop",[U.HORIZONTAL]:"scrollLeft"},f=new dt(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let h=!1,u,I=$(M([])),v=$(M({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&j(e.scrollToIndex)||0,scrollChangeReason:de.REQUESTED})),O={},_={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},y={},T=$(""),k=$("");he(()=>{e.scrollToIndex,l(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,q()}),he(()=>{m(v),A()}),he(()=>{e.height,t(),h&&H(0)}),(()=>{if(s()===U.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(s()===U.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());C()})(),Ke(()=>{u.addEventListener("scroll",le,ht),e.scrollOffset!==void 0?D(e.scrollOffset):e.scrollToIndex!==void 0&&D(j(e.scrollToIndex)),h=!0}),Ye(()=>{h&&u.removeEventListener("scroll",le)});function q(){if(!h)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const g=_.scrollToIndex!==e.scrollToIndex||_.scrollToAlignment!==l(),S=_.modelCount!==e.modelCount||_.itemSize!==e.itemSize||_.estimatedItemSize!==e.estimatedItemSize;S&&(f.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),H()),_.scrollOffset!==e.scrollOffset?V(v,M({offset:e.scrollOffset||0,scrollChangeReason:de.REQUESTED})):typeof e.scrollToIndex=="number"&&(g||S)&&V(v,M({offset:j(e.scrollToIndex,l(),e.modelCount),scrollChangeReason:de.REQUESTED})),_={scrollToIndex:e.scrollToIndex,scrollToAlignment:l(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function A(){if(!h)return;const{offset:g,scrollChangeReason:S}=m(v);(O.offset!==g||O.scrollChangeReason!==S)&&C(),O.offset!==g&&S===de.REQUESTED&&D(g),O=m(v)}function C(){if(n().length===0||e.isDisabled)return;const{offset:g}=m(v);let{start:S,end:E}=f.getVisibleRange(s()===U.VERTICAL?e.height:t(),g,r()),J=[];const W=f.getTotalSize(),re=typeof e.height=="number"?"px":"",se=typeof t()=="number"?"px":"";if(s()===U.VERTICAL?(V(T,`height:${e.height}${re};width:${t()}${se};`),V(k,`flex-direction:column;height:${W}px;`)):(V(T,`height:${e.height}${re};width:${t()}${se};`),V(k,`min-height:100%;width:${W}px;`)),n()&&S!==void 0&&E!==void 0){for(let Y=S;Y<=E;(Y+=1)-1)J.push({item:n()[Y],index:Y,style:be(Y)});if(e.onVisibleRangeUpdate){const Y=f.getVisibleRange(s()===U.VERTICAL?e.height:t(),g,0);e.onVisibleRangeUpdate({type:"range.update",start:Y.start,end:Y.end})}}V(I,M(J))}function D(g){"scroll"in u?u.scroll({[c[s()]]:g,behavior:a()}):u[d[s()]]=g}function H(g=0){y={},f.resetItem(g),C()}function j(g,S=l(),E=e.modelCount){return g<0?g=0:g>=E&&(g=E-1),f.getUpdatedOffsetForIndex(S,s()===U.VERTICAL?e.height:t(),m(v).offset||0,g)}const le=g=>{const S=u[d[s()]];S<0||m(v).offset===S||g.target!==u||(V(v,M({offset:S,scrollChangeReason:de.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:S,event:g}))};function be(g){if(y[g])return y[g];const{size:S,offset:E}=f.getSizeAndPositionForIndex(g),J=s()===U.VERTICAL?`left:0;width:100%;height:${S}px;position:absolute;top:${E}px;`:`top:0;width:${S}px;position:absolute;height:100%;left:${E}px;`;return y[g]=J}var F=ct();Xe(F,g=>u=g,()=>u);var ue=R(F);K(ue,()=>e.header,g=>{var S=Q(),E=N(S);oe(E,()=>e.header),b(g,S)});var ie=L(ue,2),Ce=R(ie);K(Ce,()=>e.isDisabled,g=>{var S=Q(),E=N(S);fe(E,17,n,Ie,(J,W,re)=>{var se=Q(),Y=N(se);oe(Y,()=>e.vl_slot,()=>({item:m(W),style:"",index:re})),b(J,se)}),b(g,S)},g=>{var S=Q(),E=N(S);fe(E,17,()=>m(I),Ie,(J,W)=>{var re=Q(),se=N(re);oe(se,()=>e.vl_slot,()=>({item:m(W).item,style:m(W).style,index:m(W).index})),b(J,re)}),b(g,S)}),w(ie);var ge=L(ie,2);return K(ge,()=>e.footer,g=>{var S=Q(),E=N(S);oe(E,()=>e.footer),b(g,S)}),w(F),B(()=>{Se(F,`virtual-list-wrapper $${o()??""} svelte-f32i87`),X(F,"style",m(T)),X(ie,"style",m(k))}),b(i,F),ne({recomputeSizes:H})}var He=(i=>(i.AUTO="auto",i.SMOOTH="smooth",i.INSTANT="instant",i))(He||{}),ce=(i=>(i.AUTO="auto",i.START="start",i.CENTER="center",i.END="end",i))(ce||{}),U=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(U||{}),de=(i=>(i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED",i))(de||{}),ut=P('<div class="tree-line tree-vline svelte-gfld7i"></div>'),gt=P('<div class="tree-line tree-hline svelte-gfld7i"></div>'),mt=P("<!> <!>",1),vt=P('<div><!> <div class="tree-node-inner"><!></div></div>');function It(i,e){te(e,!0);let t=x(e,"rtl",3,!1),n=x(e,"btt",3,!1),r=x(e,"indent",3,20),s=x(e,"treeLine",3,!0),l=x(e,"treeLineOffset",3,10),a=x(e,"class",3,""),o=x(e,"style",3,""),c=Z(()=>`${t()?"paddingRight":"paddingLeft"}:${r()*(e.nodeInfo.level-1)}px`),d=Z(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*r()+l()}px`);he(()=>{var T,k;const y=e.nodeInfo.expended;console.log("toggleOpen"),!f&&(y?(T=e.onNodeOpened)==null||T.call(e,e.nodeInfo):(k=e.onNodeclosed)==null||k.call(e,e.nodeInfo),h())}),he(()=>{var y,T;e.nodeInfo.checked,!f&&(y=e.processor)!=null&&y.afterOneCheckChanged(e.nodeInfo)&&((T=e.onNodeChecked)==null||T.call(e,e.nodeInfo))});let f=!1;const h=()=>{f=!0,setTimeout(()=>{f=!1},100)},u=Z(()=>{const y=[],T=C=>{var D;if(C.parent){let H=(D=C.parent)==null?void 0:D.children.indexOf(C);do{H+=1;const j=C.parent.children[H];if(j){if(!j.hidden)return!0}else break}while(!0)}return!1},k=t()?"right":"left",q=n()?"top":"bottom";let A=e.nodeInfo;for(;A;){const C=(A.level-2)*r()+l(),D=T(A),H=()=>{y.push({style:`${k}:${C}px;${q}:${D?"0":"50%"}`})};A===e.nodeInfo?A.level>1&&H():D&&H(),A=A.parent}return y});var I=vt();B(()=>Se(I,`${ke("tree-node",a(),s()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var v=R(I);K(v,s,y=>{var T=mt(),k=N(T);fe(k,17,()=>m(u),Ie,(A,C)=>{var D=ut();B(()=>X(D,"style",m(C).style)),b(A,D)});var q=L(k,2);K(q,()=>e.nodeInfo.level>1,A=>{var C=gt();B(()=>X(C,"style",m(d))),b(A,C)}),b(y,T)});var O=L(v,2),_=R(O);oe(_,()=>e.tn_slot,()=>({data:e.nodeInfo.nodeData,info:e.nodeInfo})),w(O),w(I),B(()=>X(I,"style",`${o()} ${m(c)}`)),b(i,I),ne()}function Oe(i){return Object.prototype.toString.call(i)==="[object Array]"}function _t(i){return i[i.length-1]}function xt(i,e){let t,n=0;for(;(t=i.indexOf(e))>-1;)i.splice(t,1),n++;return n}function St(i,e,t){i.hasOwnProperty(e)||(i[e]=t)}function bt(i,e){return Object.keys(e).forEach(t=>{St(i,t,e[t])}),i}function yt(i){const e={};return Object.keys(i).forEach(t=>{i[t]!==void 0&&(e[t]=i[t])}),e}function G(i,e,t={}){t=bt({...t},{childrenKey:"children"});const n=t.childrenKey,r=Oe(i)?i:[i];class s{}const l=(a,o,c)=>{t.reverse&&(a=a.slice(),a.reverse());const d=a.length;for(let f=0;f<d;f++){const h=a[f],u=t.reverse?d-f-1:f,I=c?[...c,u]:[];t.childFirst&&h[n]!=null&&l(h[n],h,I);const v=e(h,u,o,I);if(v===!1)throw new s;if(v==="skip children")continue;if(v==="skip siblings")break;t.childFirst||h[n]!=null&&l(h[n],h,I)}};try{l(r,null,Oe(i)?[]:null)}catch(a){if(!(a instanceof s))throw a}}function zt(i,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,r=t.nodeHandler,s=new Pe;return s.childrenKey=n,G(i,(l,a,o,c)=>{let d=Object.assign({},l);d[n]&&(d[n]=[]),r&&(d=r(d,{oldNode:l,index:a,parent:o,path:c})),s.set(c,d)},{childrenKey:n}),s.data}class Pe{constructor(e=[]){z(this,"data");z(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return Oe(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:r}=this;if(t.reverse){const s=[...this.iteratePath(e,{...t,reverse:!1})];s.reverse();for(const{path:l,node:a}of s)yield{path:l,node:a}}else{let s=[],l=r;for(const a of e){const o=[...s,a],c=l[a];yield{path:o,node:c},s=o,l=c[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return _t(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:r}=this;const{parent:s,index:l}=this.getParentAndIndex(e);let a;e.length===1?(r||(this.data?this.data[n]=[]:this.data=[]),a=r):(s[n]||(s[n]=[]),a=s[n]),a[l]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:r,index:s}=this.getParentAndIndex(e),l=e.length===1?n:r[t],a=l[s];return l.splice(s,1),a}walk(e,t){const{childrenKey:n,data:r}=this;return G(r,e,n)}clone(e={}){return zt(this.data),yt({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}class ve{constructor(e){z(this,"nodeData");z(this,"expended");z(this,"parent");z(this,"children");z(this,"level");z(this,"hidden");z(this,"checked");z(this,"draggable");z(this,"droppable");z(this,"style");z(this,"class");z(this,"_ignoreCheckedOnce");this.nodeData=(e==null?void 0:e.nodeData)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=(e==null?void 0:e.style)||null,this.class=(e==null?void 0:e.class)||null,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}class Ue{constructor(e){z(this,"childrenKey",p);z(this,"defaultOpen",!1);z(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||p,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}afterSetInfoNode(e,t,n){}afterRemoveInfoNode(e){}infoHandler(e){return e}}class Ct extends Ue{constructor(t){super(t);z(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=M(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=M(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=M(t);return this.filter(super.InfoNodesFlatHandler,n)}}const p="children";var _e,xe;class Tt{constructor(e){z(this,"nodeData");Te(this,_e,$(M([])));Te(this,xe,$(M([])));z(this,"_infosMap");z(this,"options");z(this,"initialized",!1);this._infosMap=null,this.options=e||new Ue}get nodeInfos(){return m(me(this,_e))}set nodeInfos(e){V(me(this,_e),M(e))}get nodeInfosToRender(){return m(me(this,xe))}set nodeInfosToRender(e){V(me(this,xe),M(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new Pe([]);this._infosMap=new Map,G(this.nodeData,(r,s,l,a)=>{const o=this.options.infoHandler(new ve({nodeData:r,expended:!!this.options.defaultOpen,parent:t.getParent(a),children:[],level:a.length}));this._infosMap.set(r,o),t.set(a,o)},{childrenKey:e}),console.log("td",t),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren);const n=[];t.walk(r=>{n.push(r)}),console.log("rootChildren",t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new Me("NodeInfo not found");return t}has(e){if(e instanceof ve)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof Me)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=r=>{const s=r.parent;if(s){let l=!1,a=!1;for(const c of s.children)if(c.checked||c.checked===0)l=!0;else if(a=!0,l&&a)break;const o=a?l?0:!1:!0;s.checked!==o&&(this._ignoreCheckedOnce(s),s.checked=o),n(s)}};return n(e),G(e.children,r=>{r.checked!==t&&(this._ignoreCheckedOnce(r),r.checked=t)},{childrenKey:p}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof ve?e:this.getNodeInfo(e),n=r=>!r||!r.hidden&&r.expended&&n(r.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){G(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:p})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof ve?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const r=e?e.children:this.nodeInfos;for(let s=0;s<t;(s+=1)-1)n+=this._count(r[s]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const r=t?t.children:this.nodeInfos;n==null&&(n=r.length);const s=this.options.infoHandler(new ve({expended:!!this.options.defaultOpen,nodeData:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(s,t||null,n);const l=e[this.childrenKey];if(l){const a=l.slice();for(const o of a)this.add(o,s)}}remove(e){const t=this.getSiblings(e);if(t.includes(e)){xt(t,e);const n=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),n.length);for(const r of n)this._infosMap.delete(r.nodeData);return this.options.afterRemoveInfoNode(e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const s=this._calcFlatIndex(t,n),l=this._flat(e);this.nodeInfosToRender.splice(s,0,...l);for(const a of l)this._infosMap.has(a.nodeData)||this._infosMap.set(a.nodeData,a);G(e,(a,o,c)=>{c&&(a.level=c.level+1)},{childrenKey:p}),this.options.afterSetInfoNode(e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let r;for(const s of this.iterateParent(t))if(s.level===e.level){r=s;break}if(e===r)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return G(e,n=>{t.push(n)},{childrenKey:p}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,r=new Pe([]);return r.childrenKey=n,G(t||this.nodeInfos,(s,l,a,o)=>{let c={...s.nodeData,[n]:[]};e&&(c=e(c)),r.set(o,c)},{childrenKey:p}),r.data}}_e=new WeakMap,xe=new WeakMap;class Me extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}function kt(i,e){const t=new Ct(e),n=new Tt(t);return t.noInitialization||n.init(),n}var Ot=P('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function Yt(i,e){te(e,!0);let t=x(e,"processor",23,()=>kt([],{noInitialization:!0}));x(e,"updateBehavior",3,"modify"),x(e,"childrenKey",3,p),x(e,"textKey",3,"text");let n=x(e,"indent",3,20),r=x(e,"virtualization",3,!1);x(e,"virtualizationPrerenderCount",3,20),x(e,"defaultOpen",3,!0);let s=x(e,"rtl",3,!1),l=x(e,"btt",3,!1);x(e,"nodeKey",3,"index");let a=x(e,"treeLine",3,!1),o=x(e,"treeLineOffset",3,8);x(e,"class",3,"");let c=x(e,"style",3,""),d=$(M([])),f=null,h=!1,u={};he(()=>{e.model,console.log("model change detected"),console.log("Initializing model"),t().nodeData=e.model,t().init(),V(d,M(t().nodeInfosToRender))});function I(){let k=m(d)||[];return l()&&(k=k.slice().reverse()),k.filter(q=>v(q))}function v(k){return t().isVisible(k)}var O=Z(()=>ke("he-tree",s()&&"he-tree--rtl rtl",h)),_=Z(()=>!r()),y=Z(I),T=Z(()=>{var k;return((k=t().nodeInfos)==null?void 0:k.length)||0});ft(i,{get class(){return m(O)},get style(){return c()},height:500,get isDisabled(){return m(_)},width:"auto",get model(){return m(y)},get modelCount(){return m(T)},itemSize:25,vl_slot:(q,A)=>{let C=()=>A==null?void 0:A().item;var D=Q(),H=N(D);K(H,C,j=>{var le=Z(()=>ke(C().class,{"drag-placeholder-wrapper":C().nodeData===u,"dragging-node":C()===f}));It(j,{get class(){return m(le)},get style(){return C().style},get nodeInfo(){return C()},get rtl(){return s()},get btt(){return l()},get indent(){return n()},get treeLine(){return a()},get treeLineOffset(){return o()},get processor(){return t()},onNodeOpened:F=>e.onNodeOpened&&e.onNodeOpened(F),onNodeclosed:F=>e.onNodeClosed&&e.onNodeClosed(F),onNodeChecked:F=>e.onNodeChecked&&e.onNodeChecked(F),tn_slot:(F,ue=Ge)=>{var ie=Q(),Ce=N(ie);K(Ce,()=>ue().data===u,ge=>{var g=Ot(),S=R(g);K(S,()=>e.placeholder,E=>{var J=Q(),W=N(J);oe(W,()=>e.placeholder),b(E,J)}),w(g),b(ge,g)},ge=>{var g=Q(),S=N(g);oe(S,()=>e.tree_slot,ue),b(ge,g)}),b(F,ie)}})}),b(q,D)}}),ne()}var Pt=P('<div class="item svelte-1od643n"><!></div>'),wt=P('<section class="svelte-1od643n"></section>'),At=P("<b> </b> <!>",1);function Be(i,e){te(e,!1);let t=x(e,"nodes",12),n=x(e,"node",12);const r=300;function s(f){n(n().items=f.detail.items,!0)}function l(f){n(n().items=f.detail.items,!0),t({...t()})}pe();var a=At(),o=N(a),c=R(o);w(o);var d=L(o,2);K(d,()=>{var f;return(f=n())==null?void 0:f.hasOwnProperty("items")},f=>{var h=wt();fe(h,13,()=>n().items,u=>u.id,(u,I)=>{var v=Pt(),O=R(v);Be(O,{get nodes(){return t()},set nodes(_){t(_)},get node(){return t()[m(I).id]},$$legacy:!0}),w(v),$e(v,()=>tt,()=>({duration:r})),b(u,v)}),w(h),et(h,(u,I)=>nt(u,I),()=>({items:n().items,flipDurationMs:r,centreDraggedOnCursor:!0})),Ee(()=>ee("consider",h,s)),Ee(()=>ee("finalize",h,l)),b(f,h)}),B(()=>{var f,h;X(o,"style",`color:${((f=n())==null?void 0:f.color)??""}`),ze(c,(h=n())==null?void 0:h.name)}),b(i,a),ne()}var Et=P("<h3>Try dragging node2 into node3 and then node4 into node2</h3> <!>",1);function Xt(i){let e=it({node1:{name:"node 1",items:[{id:"node2"},{id:"node3"},{id:"node4"}],id:"node1"},node2:{name:"node 2",items:[{id:"node5"},{id:"node6"},{id:"node7"},{id:"node8"}],id:"node2"},node3:{name:"node 3",items:[{id:"node9"},{id:"node10"},{id:"node11"},{id:"node12"}],id:"node3"},node4:{name:"node 4",items:[{id:"node13"},{id:"node14"},{id:"node15"},{id:"node16"}],id:"node4",color:"salmon"}});for(let r=5;r<17;(r+=1)-1)ae(e,m(e)[`node${r}`]={id:`node${r}`,name:`item ${r}`});ae(e,m(e).node10.color="steelblue"),ae(e,m(e).node11.color="steelblue"),ae(e,m(e).node14.color="orange"),ae(e,m(e).node15.color="orange"),ae(e,m(e).node6.color="forestgreen");var t=Et(),n=L(N(t),2);Be(n,{get node(){return m(e).node1},get nodes(){return m(e)},set nodes(r){V(e,r)},$$legacy:!0}),b(i,t)}var Rt=P("<div></div>");function Le(i,e){te(e,!0);const{getDragged:t}=Fe("dragging");let n=$(!1);function r(d){return 1}function s(d){!d.target||!d.target.id||(r(d.target.id),V(n,!0))}function l(d){!d.target||!d.target.id||(r(d.target.id)>0&&e.ondrop({oldPosition:t(),newPosition:d.target.id.split("-")}),a())}function a(){V(n,!1)}function o(){return`dropzone-${e.prefix}`}var c=Rt();B(()=>X(c,"id",o())),B(()=>Se(c,`${`dropzone ${m(n)?"active":"idle"}`??""} svelte-1n7j4p5`)),ee("dragleave",c,()=>a()),ee("dragenter",c,d=>s(d)),ee("drop",c,d=>l(d)),ee("dragover",c,()=>!1),b(i,c),ne()}var Nt=P("<span> </span>");function je(i,e){var t=Nt(),n=R(t);w(t),B(()=>{Se(t,`${`clickable ${e.isLeafNode?"isLeafNode":""}`??""} svelte-13dhc3a`),ze(n,e.label)}),b(i,t)}const Dt=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));function Mt(i,e){e(!e())}function Lt(i,e,t){var n;(n=e.onselected)==null||n.call(e,`${t()}`.split("-"))}var Kt=P("<i></i>"),Ft=P('<li class="svelte-1bsomvo"><!></li>'),Vt=P('<ul class="svelte-1bsomvo"><!> <li class="svelte-1bsomvo"><!></li></ul>'),Ht=P('<!> <div draggable="true"><!> <div class="node-wrapper svelte-1bsomvo"><!></div></div> <!>',1);function Qe(i,e){te(e,!0),Fe("dragging");let t=x(e,"expanded",7,!1),n=x(e,"prefix",3,""),r=Z(()=>!Array.isArray(e.children)),s=Z(()=>n()===null);function l(){}function a(_){var y;!_.target||!_.target.id||(y=e.ondragstart)==null||y.call(e,_.target.id.split("-"))}function o(_){return n()!==null?`${n()}-${_}`:_}var c=Ht(),d=N(c);K(d,()=>!m(s),_=>{Le(_,{get ondrop(){return e.ondrop},get prefix(){return n()}})});var f=L(d);f.nodeValue="  ";var h=L(f),u=R(h);K(u,()=>!m(r),_=>{var y=Kt();y.__click=[Mt,t],B(()=>Se(y,`${`clickable toggle-icon ${t()?e.internalOptions.collapseClass:e.internalOptions.expandClass}`??""} svelte-1bsomvo`)),b(_,y)});var I=L(u,2);I.__click=[Lt,e,n];var v=R(I);je(v,{get label(){return e.label},get isLeafNode(){return m(r)}}),w(I),w(h);var O=L(h,2);K(O,()=>t()&&!m(r),_=>{var y=Vt(),T=R(y);fe(T,17,()=>e.children,Ie,(C,D,H)=>{var j=Ft(),le=R(j),be=Z(()=>o(H));Qe(le,Ve(()=>m(D),{get internalOptions(){return e.internalOptions},get expanded(){return t()},get prefix(){return m(be)},get onselected(){return e.onselected},ondragenter:!0,ondragleave:!0,get ondragstart(){return e.ondragstart},ondragend:!0,get ondrop(){return e.ondrop}})),w(j),b(C,j)});var k=L(T,2),q=R(k),A=Z(()=>{var C;return o((C=e.children)==null?void 0:C.length)});Le(q,{get ondrop(){return e.ondrop},get prefix(){return m(A)}}),w(k),w(y),b(_,y)}),B(()=>X(h,"id",n())),ee("dragstart",h,_=>a(_)),ee("dragend",h,l),b(i,c),ne()}we(["click"]);var Ut=P('<div class="tree"><!></div>');function Gt(i,e){te(e,!0);let t={labelFormatter:()=>at(()=>Promise.resolve().then(()=>Dt),void 0),collapseClass:"chevron bottom",expandClass:"chevron right"};Ke(async()=>{t=Object.assign(t,e.options)});let n;rt("dragging",{getDragged:()=>n});function r(h){var u;(u=e.onselected)==null||u.call(e,l(h.slice(),e.treeItems))}function s(h){n=h.detail}function l(h,u){if(h.length===0)return u;const I=h.shift(),v=u.children[I];return v.hasOwnProperty("children")?l(h,v):v}function a(h,u){let I=[];for(let v=0;v<h.length;(v+=1)-1)h[v]===u&&I.push(v);return I}function o(h,u,I,v){if(h!==u)return h.children.indexOf(v);const O=a(h.children,v);if(O.length!==2){console.error("found too few/too many indexes",O);return}return O.find(_=>`${_}`!=`${I.slice().pop()}`)}function c(h){var T;const u=h.detail.oldPosition.slice(),I=h.detail.newPosition.slice(1),v=l(u.slice(0,u.length-1),e.treeItems),O=l(I.slice(0,I.length-1),e.treeItems),_=l(u.slice(),e.treeItems);O.children.splice(I.slice().pop(),0,_);const y=o(v,O,I.slice(),_);v.children.splice(y,1),n=null,(T=e.onmodelChanged)==null||T.call(e,e.treeItems)}var d=Ut(),f=R(d);K(f,()=>e.treeItems,h=>{Qe(h,Ve(()=>e.treeItems,{internalOptions:t,expanded:!0,onselected:u=>r(u.detail),ondragstart:u=>s(u),ondrop:c}))}),w(d),b(i,d),ne()}const Bt=(i,e)=>{e().expanded=!e().expanded},ye=(i,e,t)=>{e().checked=!e().checked,t.ontoggle&&t.ontoggle({node:e()})};var jt=P('<input type="checkbox"> <span class="arrow svelte-9p8428"></span> <span> </span> <!>',1),Qt=P('<input type="checkbox"> <span> </span>',1),Zt=P('<ul class="svelte-9p8428"><li><!></li></ul>');function Ze(i,e){te(e,!0);let t=x(e,"node",7);var n=Zt(),r=R(n),s=R(r);K(s,()=>t().children,l=>{var a=jt(),o=N(a);Re(o),o.__click=[ye,t,e];var c=L(o,2);c.__click=[Bt,t];var d=L(c,2);d.__click=[ye,t,e];var f=R(d);w(d);var h=L(d,2);K(h,()=>t().expanded,u=>{var I=Q(),v=N(I);fe(v,17,()=>t().children,Ie,(O,_)=>{var y=Q(),T=N(y);Ze(T,{get node(){return m(_)},get ontoggle(){return e.ontoggle}}),b(O,y)}),b(u,I)}),B(()=>{X(o,"data-label",t().label),Ne(o,t().checked),o.indeterminate=t().indeterminate,st(c,"arrowDown",t().expanded),ze(f,t().label)}),b(l,a)},l=>{var a=Qt(),o=N(a);Re(o),o.__click=[ye,t,e];var c=L(o,2);c.__click=[ye,t,e];var d=R(c);w(c),B(()=>{X(o,"data-label",t().label),Ne(o,t().checked),o.indeterminate=t().indeterminate,ze(d,t().label)}),b(l,a)}),w(r),w(n),b(i,n),ne()}we(["click"]);var qt=P("<div><!></div>");function pt(i){let e=M({label:"root",expanded:!0,children:[{label:"node A",children:[{label:"node Aa"},{label:"node Ab",checked:!0}]},{label:"node B"},{label:"node C"},{label:"node D"}]});const t={};function n(o=e){if(o.children)for(const c of o.children)t[c.label]=o,n(c)}n();function r(o,c=!0){if(o.children){for(const d of o.children)c&&(d.checked=!!o.checked),r(d,c);o.indeterminate=o.children.some(d=>d.indeterminate)||o.children.some(d=>!!d.checked)&&o.children.some(d=>!d.checked)}}function s(o,c=!0){const d=o.node;let f=t[d.label];for(r(d,c);f;)f.children.every(u=>!!u.checked)?(f.indeterminate=!1,f.checked=!0):(f.children.some(I=>!!I.checked||I.indeterminate)?f.indeterminate=!0:f.indeterminate=!1,f.checked=!1),f=t[f.label]}s({node:e},!1);var l=qt(),a=R(l);Ze(a,{get node(){return e},ontoggle:s}),w(l),b(i,l)}export{Xt as A,Yt as T,at as _,pt as a,Gt as b};
