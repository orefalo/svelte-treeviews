var Ae=Object.defineProperty;var Oe=i=>{throw TypeError(i)};var we=(i,e,t)=>e in i?Ae(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var h=(i,e,t)=>we(i,typeof e!="symbol"?e+"":e,t),Re=(i,e,t)=>e.has(i)||Oe("Cannot "+t);var le=(i,e,t)=>(Re(i,e,"read from private field"),t?t.call(i):e.get(i)),me=(i,e,t)=>e.has(i)?Oe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);import{d as Ne,p as xe,a as f,s as G,b as k,u as te,o as Ee,c as Me,g,e as D,f as De,h as ae,i as q,j as J,t as oe,k as b,l as Te,m as ne,n as H,q as K,r as ve,v as Ie,w as ce,x as be,y as de,z as p,A as Se,B as Q,C as Ke}from"./external.BsFOAlSY.js";Ne(["click"]);class Le{constructor(e,t,n,l){h(this,"model");h(this,"modelCount");h(this,"itemSize");h(this,"estimatedItemSize");h(this,"itemSizeAndPositionData");h(this,"lastMeasuredIndex");h(this,"totalSize");this.model=e,this.itemSize=n,this.modelCount=t,this.estimatedItemSize=l,this.itemSizeAndPositionData=[],this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig(e,t,n){t!==void 0&&(this.modelCount=t),n!==void 0&&(this.estimatedItemSize=n),e!==void 0&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!==void 0?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.modelCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?this.model?t(this.model[e],e):0:Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.modelCount;t++){const n=this.getSize(t),l=e;e+=n,this.itemSizeAndPositionData[t]={offset:l,size:n}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){return e<0||e>=this.modelCount?{size:0,offset:0}:this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let n=t.offset+t.size;for(let l=this.lastMeasuredIndex+1;l<=e;l++){const s=this.getSize(l);if(s===void 0||isNaN(s))throw Error(`Invalid size returned for index ${l} of value ${s}`);this.itemSizeAndPositionData[l]={offset:n,size:s},n+=s}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getEstimatedItemSize(){return this.estimatedItemSize||typeof this.itemSize=="number"&&this.itemSize||50}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.modelCount-this.lastMeasuredIndex-1)*this.getEstimatedItemSize()}getUpdatedOffsetForIndex(e=ee.START,t,n,l){if(t<=0)return 0;const s=this.getSizeAndPositionForIndex(l),r=s.offset,o=r-t+s.size;let a;switch(e){case ee.END:a=o;break;case ee.CENTER:a=r-(t-s.size)/2;break;case ee.START:a=r;break;default:a=Math.max(o,Math.min(r,n))}const u=this.getTotalSize();return Math.max(0,Math.min(u-t,a))}getVisibleRange(e=0,t,n){if(this.getTotalSize()===0)return{start:0,end:0};const s=t+e;let r=this.findNearestItem(t);if(r===void 0)throw Error(`Invalid offset ${t} specified`);const o=this.getSizeAndPositionForIndex(r);t=o.offset+o.size;let a=r;for(;t<s&&a<this.modelCount-1;)a++,t+=this.getSizeAndPositionForIndex(a).size;return n&&(r=Math.max(0,r-n),a=Math.min(a+n,this.modelCount-1)),{start:r,end:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),n=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch(0,n,e):this.exponentialSearch(n,e)}binarySearch(e,t,n){let l=0,s=0;for(;e<=t;){if(l=e+Math.floor((t-e)/2),s=this.getSizeAndPositionForIndex(l).offset,s===n)return l;s<n?e=l+1:s>n&&(t=l-1)}return e>0?e-1:0}exponentialSearch(e,t){let n=1;for(;e<this.modelCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=n,n*=2;return this.binarySearch(Math.floor(e/2),Math.min(e,this.modelCount-1),t)}}var Fe=ne('<div><!> <div class="virtual-list-inner svelte-f32i87"><!></div> <!></div>');const He=(()=>{let i=!1;try{const e=Object.defineProperty({},"passive",{get(){return i={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return i})();function Ve(i,e){xe(e,!0);const t=f(e,"width",3,"100%"),n=f(e,"model",19,()=>[]),l=f(e,"windowOverPadding",3,3),s=f(e,"scrollDirection",19,()=>R.VERTICAL),r=f(e,"scrollToAlignment",19,()=>ee.AUTO),o=f(e,"scrollToBehaviour",19,()=>Pe.INSTANT),a=f(e,"class",3,"");f(e,"style",3,"");const u={[R.VERTICAL]:"top",[R.HORIZONTAL]:"left"},C={[R.VERTICAL]:"scrollTop",[R.HORIZONTAL]:"scrollLeft"},I=new Le(n(),e.modelCount,e.itemSize,e.estimatedItemSize);let y=!1,x,A=G(k([])),z=G(k({offset:e.scrollOffset||e.scrollToIndex!==void 0&&e.modelCount&&B(e.scrollToIndex)||0,scrollChangeReason:$.REQUESTED})),V={},N={scrollToIndex:e.scrollToIndex,scrollToAlignment:r(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize},O={},_=G(""),v=G("");te(()=>{e.scrollToIndex,r(),e.scrollOffset,e.modelCount,e.itemSize,e.estimatedItemSize,U()}),te(()=>{g(z),T()}),te(()=>{e.height,t(),y&&E(0)}),(()=>{if(s()===R.VERTICAL&&typeof e.height!="number")throw new Error("virtual list's height must be a number when scrollDirection is 'vertical', got "+e.height);if(s()===R.HORIZONTAL&&typeof t()!="number")throw new Error("virtual list's width must be a number if scrollDirection is 'horizontal', got "+t());m()})(),Ee(()=>{x.addEventListener("scroll",ue,He),e.scrollOffset!==void 0?P(e.scrollOffset):e.scrollToIndex!==void 0&&P(B(e.scrollToIndex)),y=!0}),Me(()=>{y&&x.removeEventListener("scroll",ue)});function U(){if(!y)return;e.scrollToIndex&&e.scrollOffset&&console.log("VirtualList: scrollToIndex and scrollOffset shall not be used together.");const d=N.scrollToIndex!==e.scrollToIndex||N.scrollToAlignment!==r(),c=N.modelCount!==e.modelCount||N.itemSize!==e.itemSize||N.estimatedItemSize!==e.estimatedItemSize;c&&(I.updateConfig(e.itemSize,e.modelCount,e.estimatedItemSize),E()),N.scrollOffset!==e.scrollOffset?D(z,k({offset:e.scrollOffset||0,scrollChangeReason:$.REQUESTED})):typeof e.scrollToIndex=="number"&&(d||c)&&D(z,k({offset:B(e.scrollToIndex,r(),e.modelCount),scrollChangeReason:$.REQUESTED})),N={scrollToIndex:e.scrollToIndex,scrollToAlignment:r(),scrollOffset:e.scrollOffset,modelCount:e.modelCount,itemSize:e.itemSize,estimatedItemSize:e.estimatedItemSize}}function T(){if(!y)return;const{offset:d,scrollChangeReason:c}=g(z);(V.offset!==d||V.scrollChangeReason!==c)&&m(),V.offset!==d&&c===$.REQUESTED&&P(d),V=g(z)}function m(){if(n().length===0||e.isDisabled)return;const{offset:d}=g(z);let{start:c,end:S}=I.getVisibleRange(s()===R.VERTICAL?e.height:t(),d,l()),M=[];const L=I.getTotalSize(),Y=typeof e.height=="number"?"px":"",X=typeof t()=="number"?"px":"";if(s()===R.VERTICAL?(D(_,`height:${e.height}${Y};width:${t()}${X};`),D(v,`flex-direction:column;height:${L}px;`)):(D(_,`height:${e.height}${Y};width:${t()}${X};`),D(v,`min-height:100%;width:${L}px;`)),n()&&c!==void 0&&S!==void 0){for(let F=c;F<=S;(F+=1)-1)M.push({item:n()[F],index:F,style:Ce(F)});if(e.onVisibleRangeUpdate){const F=I.getVisibleRange(s()===R.VERTICAL?e.height:t(),d,0);e.onVisibleRangeUpdate({type:"range.update",start:F.start,end:F.end})}}D(A,k(M))}function P(d){"scroll"in x?x.scroll({[u[s()]]:d,behavior:o()}):x[C[s()]]=d}function E(d=0){O={},I.resetItem(d),m()}function B(d,c=r(),S=e.modelCount){return d<0?d=0:d>=S&&(d=S-1),I.getUpdatedOffsetForIndex(c,s()===R.VERTICAL?e.height:t(),g(z).offset||0,d)}const ue=d=>{const c=x[C[s()]];c<0||g(z).offset===c||d.target!==x||(D(z,k({offset:c,scrollChangeReason:$.OBSERVED})),e.onAfterScroll&&e.onAfterScroll({type:"scroll.update",offset:c,event:d}))};function Ce(d){if(O[d])return O[d];const{size:c,offset:S}=I.getSizeAndPositionForIndex(d),M=s()===R.VERTICAL?`left:0;width:100%;height:${c}px;position:absolute;top:${S}px;`:`top:0;width:${c}px;position:absolute;height:100%;left:${S}px;`;return O[d]=M}var w=Fe();De(w,d=>x=d,()=>x);var ie=ae(w);q(ie,()=>e.header,d=>{var c=H(),S=K(c);p(S,()=>e.header),b(d,c)});var W=J(J(ie,!0)),ge=ae(W);q(ge,()=>e.isDisabled,d=>{var c=H(),S=K(c);ve(S,17,n,Ie,(M,L,Y)=>{var X=H(),F=K(X);p(F,()=>e.vl_slot,()=>({item:g(L),style:"",index:Y})),b(M,X)}),b(d,c)},d=>{var c=H(),S=K(c);ve(S,17,()=>g(A),Ie,(M,L)=>{var Y=H(),X=K(Y);p(X,()=>e.vl_slot,()=>({item:g(L).item,style:g(L).style,index:g(L).index})),b(M,Y)}),b(d,c)}),ce(W);var se=J(J(W,!0));return q(se,()=>e.footer,d=>{var c=H(),S=K(c);p(S,()=>e.footer),b(d,c)}),ce(w),oe(()=>{be(w,`virtual-list-wrapper $${a()??""} svelte-f32i87`),de(w,"style",g(_)),de(W,"style",g(v))}),b(i,w),Te({recomputeSizes:E})}var Pe=(i=>(i.AUTO="auto",i.SMOOTH="smooth",i.INSTANT="instant",i))(Pe||{}),ee=(i=>(i.AUTO="auto",i.START="start",i.CENTER="center",i.END="end",i))(ee||{}),R=(i=>(i.HORIZONTAL="horizontal",i.VERTICAL="vertical",i))(R||{}),$=(i=>(i[i.OBSERVED=0]="OBSERVED",i[i.REQUESTED=1]="REQUESTED",i))($||{}),Ue=ne('<div class="tree-line tree-vline svelte-gfld7i"></div>'),Be=ne('<div class="tree-line tree-hline svelte-gfld7i"></div>'),je=ne("<!> <!>",1),Qe=ne('<div><!> <div class="tree-node-inner"><!></div></div>');function Ze(i,e){xe(e,!0);let t=f(e,"rtl",3,!1),n=f(e,"btt",3,!1),l=f(e,"indent",3,20),s=f(e,"treeLine",3,!0),r=f(e,"treeLineOffset",3,10),o=f(e,"class",3,""),a=f(e,"style",3,""),u=Q(()=>`${t()?"paddingRight":"paddingLeft"}:${l()*(e.nodeInfo.level-1)}px`),C=Q(()=>`${t()?"right":"left"}:${(e.nodeInfo.level-2)*l()+r()}px`);te(()=>{var _,v;const O=e.nodeInfo.expended;console.log("toggleOpen"),!I&&(O?(_=e.onNodeOpened)==null||_.call(e,e.nodeInfo):(v=e.onNodeclosed)==null||v.call(e,e.nodeInfo),y())}),te(()=>{var O,_;e.nodeInfo.checked,!I&&(O=e.processor)!=null&&O.afterOneCheckChanged(e.nodeInfo)&&((_=e.onNodeChecked)==null||_.call(e,e.nodeInfo))});let I=!1;const y=()=>{I=!0,setTimeout(()=>{I=!1},100)},x=Q(()=>{const O=[],_=m=>{var P;if(m.parent){let E=(P=m.parent)==null?void 0:P.children.indexOf(m);do{E+=1;const B=m.parent.children[E];if(B){if(!B.hidden)return!0}else break}while(!0)}return!1},v=t()?"right":"left",U=n()?"top":"bottom";let T=e.nodeInfo;for(;T;){const m=(T.level-2)*l()+r(),P=_(T),E=()=>{O.push({style:`${v}:${m}px;${U}:${P?"0":"50%"}`})};T===e.nodeInfo?T.level>1&&E():P&&E(),T=T.parent}return O});var A=Qe();oe(()=>be(A,`${Se("tree-node",o(),s()&&"tree-node--with-tree-line")??""} svelte-gfld7i`));var z=ae(A);q(z,s,O=>{var _=je(),v=K(_);ve(v,17,()=>g(x),Ie,(T,m)=>{var P=Ue();oe(()=>de(P,"style",g(m).style)),b(T,P)});var U=J(J(v,!0));q(U,()=>e.nodeInfo.level>1,T=>{var m=Be();oe(()=>de(m,"style",g(C))),b(T,m)}),b(O,_)});var V=J(J(z,!0)),N=ae(V);p(N,()=>e.tn_slot,()=>({data:e.nodeInfo.nodeData,info:e.nodeInfo})),ce(V),ce(A),oe(()=>de(A,"style",`${a()} ${g(u)}`)),b(i,A),Te()}function ze(i){return Object.prototype.toString.call(i)==="[object Array]"}function Je(i){return i[i.length-1]}function qe(i,e){let t,n=0;for(;(t=i.indexOf(e))>-1;)i.splice(t,1),n++;return n}function We(i,e,t){i.hasOwnProperty(e)||(i[e]=t)}function Ye(i,e){return Object.keys(e).forEach(t=>{We(i,t,e[t])}),i}function Xe(i){const e={};return Object.keys(i).forEach(t=>{i[t]!==void 0&&(e[t]=i[t])}),e}function j(i,e,t={}){t=Ye({...t},{childrenKey:"children"});const n=t.childrenKey,l=ze(i)?i:[i];class s{}const r=(o,a,u)=>{t.reverse&&(o=o.slice(),o.reverse());const C=o.length;for(let I=0;I<C;I++){const y=o[I],x=t.reverse?C-I-1:I,A=u?[...u,x]:[];t.childFirst&&y[n]!=null&&r(y[n],y,A);const z=e(y,x,a,A);if(z===!1)throw new s;if(z==="skip children")continue;if(z==="skip siblings")break;t.childFirst||y[n]!=null&&r(y[n],y,A)}};try{r(l,null,ze(i)?[]:null)}catch(o){if(!(o instanceof s))throw o}}function Ge(i,e){const t={childrenKey:"children"};e&&Object.assign(t,e);const n=t.childrenKey,l=t.nodeHandler,s=new ye;return s.childrenKey=n,j(i,(r,o,a,u)=>{let C=Object.assign({},r);C[n]&&(C[n]=[]),l&&(C=l(C,{oldNode:r,index:o,parent:a,path:u})),s.set(u,C)},{childrenKey:n}),s.data}class ye{constructor(e=[]){h(this,"data");h(this,"childrenKey","children");this.data=e}get rootChildren(){const{childrenKey:e}=this,{data:t}=this;return ze(t)?t:t[e]}*iteratePath(e,t={}){const{childrenKey:n,rootChildren:l}=this;if(t.reverse){const s=[...this.iteratePath(e,{...t,reverse:!1})];s.reverse();for(const{path:r,node:o}of s)yield{path:r,node:o}}else{let s=[],r=l;for(const o of e){const a=[...s,o],u=r[o];yield{path:a,node:u},s=a,r=u[n]}}}getFamily(e){const t=[];for(const{node:n}of this.iteratePath(e))t.push(n);return t}get(e){return Je(this.getFamily(e))}getParentAndIndex(e){const t=e.slice(),n=t.pop();return{parent:this.get(t),index:n,parentPath:t}}getParent(e){return this.getParentAndIndex(e).parent}set(e,t){if(e===null||e.length===0)this.data=t;else{const{childrenKey:n}=this;let{rootChildren:l}=this;const{parent:s,index:r}=this.getParentAndIndex(e);let o;e.length===1?(l||(this.data?this.data[n]=[]:this.data=[]),o=l):(s[n]||(s[n]=[]),o=s[n]),o[r]=t}}delete(e){const{childrenKey:t,rootChildren:n}=this,{parent:l,index:s}=this.getParentAndIndex(e),r=e.length===1?n:l[t],o=r[s];return r.splice(s,1),o}walk(e,t){const{childrenKey:n,data:l}=this;return j(l,e,n)}clone(e={}){return Ge(this.data),Xe({childrenKey:this.childrenKey,nodeHandler:e.nodeHandler||void 0})}}class re{constructor(e){h(this,"nodeData");h(this,"expended");h(this,"parent");h(this,"children");h(this,"level");h(this,"hidden");h(this,"checked");h(this,"draggable");h(this,"droppable");h(this,"style");h(this,"class");h(this,"_ignoreCheckedOnce");this.nodeData=(e==null?void 0:e.nodeData)||null,this.expended=(e==null?void 0:e.expended)||!1,this.parent=(e==null?void 0:e.parent)||null,this.children=(e==null?void 0:e.children)||[],this.level=(e==null?void 0:e.level)||0,this.hidden=(e==null?void 0:e.hidden)||!1,this.checked=(e==null?void 0:e.checked)||!1,this.draggable=(e==null?void 0:e.draggable)||null,this.droppable=(e==null?void 0:e.droppable)||null,this.style=(e==null?void 0:e.style)||null,this.class=(e==null?void 0:e.class)||null,this._ignoreCheckedOnce=e==null?void 0:e._ignoreCheckedOnce}toggleExpand(){console.log("nodeInfo.toggleExpand"),this.expended=!this.expended,console.log(this.expended)}toggleChecked(){console.log("nodeInfo.toggleChecked"),this.checked=!this.checked,console.log(this.checked)}}class ke{constructor(e){h(this,"childrenKey",Z);h(this,"defaultOpen",!1);h(this,"noInitialization",!1);this.childrenKey=(e==null?void 0:e.childrenKey)||Z,this.defaultOpen=(e==null?void 0:e.defaultOpen)||!1,this.noInitialization=(e==null?void 0:e.noInitialization)||!1}infoNodesHandler(e){return e}InfoNodesFlatHandler(e){return e}afterSetInfoNode(e,t,n){}afterRemoveInfoNode(e){}infoHandler(e){return e}}class pe extends ke{constructor(t){super(t);h(this,"preProcessor")}filter(t,n){return t?t(n):n}infoHandler(t){this.preProcessor&&(t=this.preProcessor(t));let n=k(t);return this.filter(super.infoHandler,n)}infoNodesHandler(t){let n=k(t);return this.filter(super.infoNodesHandler,n)}InfoNodesFlatHandler(t){let n=k(t);return this.filter(super.InfoNodesFlatHandler,n)}}const Z="children";var he,fe;class $e{constructor(e){h(this,"nodeData");me(this,he,G(k([])));me(this,fe,G(k([])));h(this,"_infosMap");h(this,"options");h(this,"initialized",!1);this._infosMap=null,this.options=e||new ke}get nodeInfos(){return g(le(this,he))}set nodeInfos(e){D(le(this,he),k(e))}get nodeInfosToRender(){return g(le(this,fe))}set nodeInfosToRender(e){D(le(this,fe),k(e))}init(){if(!this.initialized){this.initialized=!0,console.log("TreeProcessor.init() called");const e=this.options.childrenKey,t=new ye([]);this._infosMap=new Map,j(this.nodeData,(l,s,r,o)=>{const a=this.options.infoHandler(new re({nodeData:l,expended:!!this.options.defaultOpen,parent:t.getParent(o),children:[],level:o.length}));this._infosMap.set(l,a),t.set(o,a)},{childrenKey:e}),console.log("td",t),this.nodeInfos=this.options.infoNodesHandler(t.rootChildren);const n=[];t.walk(l=>{n.push(l)}),console.log("rootChildren",t.rootChildren),this.nodeInfosToRender=this.options.InfoNodesFlatHandler(n)}}getNodeInfo(e){const t=this._infosMap.get(e);if(!t)throw new _e("NodeInfo not found");return t}has(e){if(e instanceof re)return this.nodeInfosToRender.indexOf(e)>-1;try{return(!!this.getNodeInfo(e)).valueOf()}catch(t){if(t instanceof _e)return!1;throw t}}_getPathByStat(e){if(e===null)return[];const n=this.getSiblings(e).indexOf(e);return[...e.parent?this._getPathByStat(e.parent):[],n]}afterOneCheckChanged(e){const{checked:t}=e;if(e._ignoreCheckedOnce)return delete e._ignoreCheckedOnce,!1;const n=l=>{const s=l.parent;if(s){let r=!1,o=!1;for(const u of s.children)if(u.checked||u.checked===0)r=!0;else if(o=!0,r&&o)break;const a=o?r?0:!1:!0;s.checked!==a&&(this._ignoreCheckedOnce(s),s.checked=a),n(s)}};return n(e),j(e.children,l=>{l.checked!==t&&(this._ignoreCheckedOnce(l),l.checked=t)},{childrenKey:Z}),!0}_ignoreCheckedOnce(e){e._ignoreCheckedOnce=!0,setTimeout(()=>{e._ignoreCheckedOnce&&(e._ignoreCheckedOnce=!1)},100)}isVisible(e){const t=e instanceof re?e:this.getNodeInfo(e),n=l=>!l||!l.hidden&&l.expended&&n(l.parent);return!!(!t.hidden&&n(t.parent))}updateCheckboxes(){j(this.nodeInfos,e=>{if(e.children&&e.children.length>0){const t=e.children.every(n=>n.checked);e.checked!==t&&(this._ignoreCheckedOnce(e),e.checked=t)}},{childFirst:!0,childrenKey:Z})}getChecked(e=!1){return this.nodeInfosToRender.filter(t=>t.checked||e&&t.checked===0)}getUnchecked(e=!0){return this.nodeInfosToRender.filter(t=>e?!t.checked:t.checked===!1)}openAll(){for(const e of this.nodeInfosToRender)e.expended=!0}closeAll(){for(const e of this.nodeInfosToRender)e.expended=!1}openNodeAndParents(e){const t=e instanceof re?e:this.getNodeInfo(e);for(const n of this.iterateParent(t,{withSelf:!0}))n.expended=!0}_calcFlatIndex(e,t){let n=e?this.nodeInfosToRender.indexOf(e)+1:0;const l=e?e.children:this.nodeInfos;for(let s=0;s<t;(s+=1)-1)n+=this._count(l[s]);return n}add(e,t,n){if(this.has(e))throw"Can't add because data exists in tree";const l=t?t.children:this.nodeInfos;n==null&&(n=l.length);const s=this.options.infoHandler(new re({expended:!!this.options.defaultOpen,nodeData:e,parent:t||null,children:[],level:t?t.level+1:1}));this._setPosition(s,t||null,n);const r=e[this.childrenKey];if(r){const o=r.slice();for(const a of o)this.add(a,s)}}remove(e){const t=this.getSiblings(e);if(t.includes(e)){qe(t,e);const n=this._flat(e);this.nodeInfosToRender.splice(this.nodeInfosToRender.indexOf(e),n.length);for(const l of n)this._infosMap.delete(l.nodeData);return this.options.afterRemoveInfoNode(e),!0}return!1}getSiblings(e){const{parent:t}=e;return t?t.children:this.nodeInfos}_setPosition(e,t,n){(t?t.children:this.nodeInfos).splice(n,0,e),e.parent=t,e.level=t?t.level+1:1;const s=this._calcFlatIndex(t,n),r=this._flat(e);this.nodeInfosToRender.splice(s,0,...r);for(const o of r)this._infosMap.has(o.nodeData)||this._infosMap.set(o.nodeData,o);j(e,(o,a,u)=>{u&&(o.level=u.level+1)},{childrenKey:Z}),this.options.afterSetInfoNode(e,t,n)}*iterateParent(e,t){let n=t!=null&&t.withSelf?e:e.parent;for(;n;)yield n,n=n.parent}move(e,t,n){if(this.has(e)){if(e.parent===t&&this.getSiblings(e).indexOf(e)===n)return!1;if(e===t)throw new Error("Can't move node to itself");if(t&&e.level<t.level){let l;for(const s of this.iterateParent(t))if(s.level===e.level){l=s;break}if(e===l)throw new Error("Can't move node to its descendant")}this.remove(e)}return this._setPosition(e,t,n),!0}_flat(e){const t=[];return j(e,n=>{t.push(n)},{childrenKey:Z}),t}_count(e){return this._flat(e).length}getData(e,t){const{childrenKey:n}=this.options,l=new ye([]);return l.childrenKey=n,j(t||this.nodeInfos,(s,r,o,a)=>{let u={...s.nodeData,[n]:[]};e&&(u=e(u)),l.set(a,u)},{childrenKey:Z}),l.data}}he=new WeakMap,fe=new WeakMap;class _e extends Error{constructor(e){super(e),this.name="StatNotFoundError"}}function et(i,e){const t=new pe(e),n=new $e(t);return t.noInitialization||n.init(),n}var tt=ne('<div class="drag-placeholder he-tree-drag-placeholder"><!></div>');function st(i,e){xe(e,!0);let t=f(e,"processor",23,()=>et([],{noInitialization:!0}));f(e,"updateBehavior",3,"modify"),f(e,"childrenKey",3,Z),f(e,"textKey",3,"text");let n=f(e,"indent",3,20),l=f(e,"virtualization",3,!1);f(e,"virtualizationPrerenderCount",3,20),f(e,"defaultOpen",3,!0);let s=f(e,"rtl",3,!1),r=f(e,"btt",3,!1);f(e,"nodeKey",3,"index");let o=f(e,"treeLine",3,!1),a=f(e,"treeLineOffset",3,8);f(e,"class",3,"");let u=f(e,"style",3,""),C=G(k([])),I=null,y=!1,x={};te(()=>{e.model,console.log("model change detected"),console.log("Initializing model"),t().nodeData=e.model,t().init(),D(C,k(t().nodeInfosToRender))});function A(){let v=g(C)||[];return r()&&(v=v.slice().reverse()),v.filter(U=>z(U))}function z(v){return t().isVisible(v)}var V=Q(()=>Se("he-tree",s()&&"he-tree--rtl rtl",y)),N=Q(()=>!l()),O=Q(A),_=Q(()=>{var v;return((v=t().nodeInfos)==null?void 0:v.length)||0});Ve(i,{get class(){return g(V)},get style(){return u()},height:500,get isDisabled(){return g(N)},width:"auto",get model(){return g(O)},get modelCount(){return g(_)},itemSize:25,vl_slot:(U,T)=>{let m=()=>T==null?void 0:T().item;var P=H(),E=K(P);q(E,m,B=>{var ue=Q(()=>Se(m().class,{"drag-placeholder-wrapper":m().nodeData===x,"dragging-node":m()===I}));Ze(B,{get class(){return g(ue)},get style(){return m().style},get nodeInfo(){return m()},get rtl(){return s()},get btt(){return r()},get indent(){return n()},get treeLine(){return o()},get treeLineOffset(){return a()},get processor(){return t()},onNodeOpened:w=>e.onNodeOpened&&e.onNodeOpened(w),onNodeclosed:w=>e.onNodeClosed&&e.onNodeClosed(w),onNodeChecked:w=>e.onNodeChecked&&e.onNodeChecked(w),tn_slot:(w,ie=Ke)=>{var W=H(),ge=K(W);q(ge,()=>ie().data===x,se=>{var d=tt(),c=ae(d);q(c,()=>e.placeholder,S=>{var M=H(),L=K(M);p(L,()=>e.placeholder),b(S,M)}),ce(d),b(se,d)},se=>{var d=H(),c=K(d);p(c,()=>e.tree_slot,ie),b(se,d)}),b(w,W)}})}),b(U,P)}}),Te()}export{st as T};
